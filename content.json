{"pages":[{"title":"Categories","text":"","link":"/categories/index.html"},{"title":"Tags","text":"","link":"/tags/index.html"},{"title":"About","text":"æˆ‘å«é™³å¼˜æ¯…ï¼Œéå»åŒäº‹å€‘ç¿’æ…£å«æˆ‘çš„è‹±æ–‡åå­— Brianï¼Œéå» 2 ~ 3 å¹´å°ˆæ³¨åœ¨ç¶²é å‰ç«¯ã€APP é–‹ç™¼ï¼Œå‰ç«¯ç†Ÿæ‚‰ React/React Native ç”Ÿæ…‹ç³»ï¼Œå¾Œç«¯ç†Ÿæ‚‰ Node.js ç”Ÿæ…‹ç³»ï¼Œåƒèˆ‡é 4 å€‹ production å°ˆæ¡ˆï¼Œæœ‰å»ºç½® React E2E æ¸¬è©¦ç¶“é©—ã€‚ç›®å‰å¸Œæœ›ç”±å‰ç«¯è½‰å‘å¾Œç«¯é–‹ç™¼ã€‚ æˆ‘ç†±æ„›å­¸ç¿’ä»¥åŠæŒ‘æˆ°ï¼Œéå»åœ˜éšŠä¸­ï¼Œæ¯ç•¶è¦åˆ†é… sprint çš„ ticket çš„æ™‚å€™ï¼Œæˆ‘ç¸½æ˜¯ç¬¬ä¸€å€‹çˆ­å–åšæœ€è¤‡é›œã€å›°é›£çš„åŠŸèƒ½ï¼Œå³ä¾¿ç•¶ä¸‹æˆ‘å¯èƒ½å°é€™å€‹è¦é–‹ç™¼åŠŸèƒ½å®Œå…¨ä¸äº†è§£ï¼Œä½†æˆ‘é¡˜èŠ±å¤§é‡æ™‚é–“ç ”ç©¶ã€å¯¦ä½œä¸”åœ¨æ¯å€‹ sprint éƒ½èƒ½æº–æ™‚äº¤ä»˜åŠŸèƒ½ï¼Œä¹Ÿå› æ­¤åœ¨éå»çš„å…©å¹´å…§ï¼Œæˆ‘é‡æ§‹äº†ç³»çµ±ä¸»åŠŸèƒ½ã€å»ºç½® E2E æ¸¬è©¦ã€å¯¦ä½œè—èŠ½åŠŸèƒ½ã€å¯¦ä½œ iOS widget èˆ‡ React Native ä¸²æ¥ï¼Œç‚ºäº†åŠ å¼·åŸºç¤ä»¥åŠå­¸ç¿’å¾Œç«¯é–‹ç™¼ï¼Œæˆ‘åœ¨ä»Šå¹´ 3 æœˆé›¢è·ï¼Œå°ˆæ³¨åœ¨å°‡åŸºç¤æ‰“ç©©å’Œå­¸ç¿’å¾Œç«¯é–‹ç™¼ï¼Œå› ç‚ºæˆ‘å¸Œæœ›æˆ‘èƒ½ä¸åªç•¶ä¸€å€‹å‰ç«¯å·¥ç¨‹å¸« æˆ‘ç†±æ„›åˆ†äº«ï¼Œéå»åœ¨å‰å…¬å¸ï¼Œæˆ‘å¸¸å¸¸åœ¨é€±æœƒåˆ†äº«çœ‹åˆ°çš„æ–°æŠ€è¡“æˆ–è¨­è¨ˆæ–¹å¼ï¼Œå…¶å¯¦åŒ…å«æ¨å»£ Typescript ã€React Hooks å’Œ React å…ƒä»¶è¨­è¨ˆæ¨¡å¼ç­‰ç­‰ï¼Œæˆ‘ç†±æ„›å­¸ç¿’ã€æ›´ç†±æ„›èˆ‡äººåˆ†äº«ä»¥åŠäº¤æµæˆ‘çš„å­¸ç¿’æˆæœï¼Œå› ç‚ºæˆ‘æ·±ä¿¡æ•™å­¸å°±æ˜¯å­¸ç¿’æœ€å¥½çš„æ–¹å¼ Hello! My name is Brian. Iâ€™m a frontend/APP developer has over 3 years experience. Familiar with React and Node.js ecosystem. My primary programming language is TypeScript. Participated in four production projects. Have experience build E2E testing infrastructure and CI process. Currently seeking for opportunities to transition from frontend development to backend development. I love learning and challenges. In the past 2 years , i always the one willing to take on the most complex and challenging task when assigning ticket every sprint. Even though, i didnâ€™t fully understand how to develop the feature or functionality. I would spend a lot time to survey and implement the feature and deliver the requirement on time. Therefore, in past two years, i refactored core functionality in project, construct E2E test, implement bluetooth and iOS Widget on React Native project. I left my previous company in this March for learning more about the fundamental of computer science and backend development because i want to be more than a frontend dev. I love sharing my learnings. At previous company, i often shared new technologies and design pattern on weekly meeting including TypesScript, React Hooks, React component design patterns and more. Because i believe in teaching is the best way of learning.","link":"/about/index.html"}],"posts":[{"title":"Linux Command å…¥é–€(ä¸€)","text":"Linux æŒ‡ä»¤åŸºæœ¬çµæ§‹Command çµæ§‹: command åç¨± + option + inputs, command æ˜¯æœ‰åˆ†å¤§å°å¯«çš„ å‘½ä»¤æ˜¯å¦‚ä½•è¢«åŸ·è¡Œçš„:$PATH å®šç¾©äº†å¯åŸ·è¡Œæª”çš„ä½ç½®ï¼Œè¼¸å…¥å‘½ä»¤å¾Œï¼Œæœƒåœ¨æœ‰å®šç¾© $PATH çš„æ–‡ä»¶å¤¾ä¸­æ‰¾å°‹åŸ·è¡Œæª”ï¼Œå¦‚æœæŸå€‹åŸ·è¡ŒæŸå€‹åŸ·è¡Œæª”çš„åç¨±ç›¸åŒï¼Œæœƒç”±æœ€å·¦é‚Šçš„æª”æ¡ˆå¤¾è¢«åŸ·è¡Œ which: æ‰¾åˆ°æ­¤å‘½ä»¤çš„åŸ·è¡Œæª”ä½ç½® command å¯ä»¥æ¥å—å¤šå€‹åƒæ•¸: æ‰¾ 2017 å¹´ 12 æœˆçš„æœˆæ›† é•·ã€çŸ­ option: -v æ˜¯çŸ­ option, --version æ˜¯é•· option, ä½†æ˜¯ä¸ä¸€å®šæœƒæœ‰é•· option æ‰‹å†Šé  Manual Pageæ¯å€‹ command éƒ½æœ‰å„è‡ªçš„åƒæ•¸ï¼Œå¯ä»¥é€éæŸ¥è©¢æ‰‹å†Šé ä¾†çŸ¥é“ç”¨æ³•è·Ÿåƒæ•¸ æ‰‹å†Šé çµæ§‹ åŠ ç²—çš„æ˜¯å¸¸ç”¨å‘½ä»¤å€å¡Š Section å…§å®¹ å‚™è¨» 1 User Commands ä¸€èˆ¬ä¸éœ€è¦æ¬Šé™çš„å‘½ä»¤ ex: cal, date 2 System Calls å¤šåŠä½¿ç”¨åœ¨æ‡‰ç”¨ç¨‹å¼è£¡ï¼Œå¯ä»¥å‘ Linux Kernal ä¸‹çš„å‘½ä»¤ 3 C Library Functions çµ¦ C èªè¨€ç”¨çš„ Library functions 4 Devices and Sepcial Files ç®¡ç†è£ç½®ï¼Œexï¼šå…‰ç¢Ÿæ©Ÿã€USB Port 5 File Formats and Convetions 6 Games 7 Miscellaneous Protocals, File systems ç›¸é—œè³‡è¨Š 8 System Administration éœ€è¦æ¬Šé™çš„å‘½ä»¤, ex: æ”¹å¯†ç¢¼ã€ç·¨è¼¯é‡è¦æ–‡ä»¶ã€è¨­å®šè‡ªå‹•åŒ–ç­‰â€¦ ä½¿ç”¨ Manual Pageæ‰¾å°‹ç›¸é—œå‘½ä»¤èªæ³•: man -k {ä½ è¦æ‰¾çš„å‘½ä»¤}ex: èˆ‡ which ç›¸é—œçš„ command, æˆ‘å€‘è¦æ‰¾çš„ which å‘½ä»¤åœ¨æœ€å¾Œä¸€å€‹ï¼Œç„¶å¾Œæ‹¬è™Ÿè£¡é¢çš„ 1 ä»£è¡¨å®ƒåœ¨ section 1 æŸ¥çœ‹å‘½ä»¤ Man Pageèªæ³•ï¼š man {section} {ä½ è¦æ‰¾çš„å‘½ä»¤},ex: ä¸‹ man 1 which, æ‰¾åœ¨ section 1 çš„ which å‘½ä»¤ï¼Œsection 1 çš„å‘½ä»¤å› ç‚ºå¤ªå¸¸ç”¨ï¼Œæ‰€ä»¥å¯ä»¥çœç•¥ 1Man page è£¡ç¬¦è™Ÿè§£é‡‹ï¼š [] è¡¨ç¤ºé¸å‰‡æ€§çš„é¸é …, [-a | -f] è¡¨ç¤ºèƒ½ä½¿ç”¨ -a å’Œ -f å…¶ä¸­ä¸€å€‹é¸é …ï¼Œ ...: è¡¨ç¤ºå¯ä»¥å¤šå€‹åƒæ•¸ &lt;&gt;: ä»£è¡¨å¿…å¡« ä»¥ä¸‹ç‚ºèˆ‰ä¾‹ï¼ŒéçœŸå¯¦ commandï¼š command [-a] &lt;filename&gt; ...: æœ‰ -a é€™å€‹é¸æ“‡æ€§é¸é …ï¼Œä¸” fileanme ç‚ºå¿…å¡«ï¼Œå¯å¤šå€‹ command [-a | -f] &lt;path&gt;: æœ‰ -a å’Œ -f å…©å€‹é¸æ“‡æ€§é¸é …ï¼Œä¸¦éœ€è¦çµ¦ä¸€å€‹ path åƒæ•¸ command [OPTION]... [FILE]...: å¯é¸æ“‡æ€§ä½¿ç”¨å¤šå€‹ option, å’Œå¤šå€‹ file åƒæ•¸, ä½†å› ç‚ºéƒ½æ˜¯ optional çš„ï¼Œå› æ­¤å¯ä»¥ç›´æ¥ä½¿ç”¨ command","link":"/2021/07/23/Linux-Command-%E5%85%A5%E9%96%80-%E4%B8%80/"},{"title":"Linux Command å…¥é–€(äºŒ)","text":"äº†è§£ Command çš„è¼¸å…¥èˆ‡è¼¸å‡ºæ–¹å¼ï¼Œå¦‚ä½•å‚³é Command çš„çµæœçµ¦ä¸‹å€‹ Commandï¼Œå¯ä»¥è®“ä½ çœŸæ­£æ„Ÿå—åˆ° Shell çš„å¼·å¤§ï¼Œå»¢è©±ä¸å¤šèªªå°±é¦¬ä¸Šé–‹å§‹å§ï¼ Command çš„ Input å’Œ Outputçµ¦ Commandè¼¸å…¥çš„è³‡æ–™å¯ä»¥æ˜¯ Standard Input æˆ–è€…æ˜¯åƒæ•¸, Command åŸ·è¡Œå®Œçš„çµæœæ˜¯ Standard Output æˆ–æ˜¯Standard Errorï¼ŒStandard Output å’Œ Error é è¨­çš„è¼¸å‡ºä½ç½®æ˜¯ Terminal Standard Input: é è¨­æ˜¯éµç›¤è¼¸å…¥ æˆ‘å€‘ç”¨ cat command èˆ‰ä¾‹ï¼Œæˆ‘å€‘å…ˆæŸ¥çœ‹ cat æŒ‡ä»¤çš„ man pageèªªæ˜å¯«è‘—ï¼Œå¦‚æœæ²’æœ‰çµ¦ file åƒæ•¸çš„è©±ï¼Œå°±æœƒå¾ standard input è®€å– æˆ‘å€‘è©¦è©¦çœ‹åªçµ¦ cat command ä¸çµ¦åƒæ•¸å¾Œï¼Œæˆ‘å€‘å°±å¯ä»¥æ‰“å­—ç”¨ input çµ¦ cat Rediretionå°‡ Standard Iput, Out, Error çš„ data stream è½‰å‘é terminal çš„åœ°æ–¹ æ¯å€‹ data stream éƒ½æœ‰å…¶ä»£è¡¨çš„æ•¸å­— standard input: 0 standard output: 1 standard error: 2 ExampleStandard Output ç¯„ä¾‹:cat 1&gt; output.txt è£¡çš„ 1 å°±ä»£è¡¨ standard output, &gt; ä»£è¡¨è¼¸å‡ºçš„ä½ç½®ï¼Œä¹Ÿå¯ä»¥çœç•¥ 1 cat &gt; output.txt å¦‚æœä½ å·²ç¶“æœ‰ output.txt æª”äº†ï¼ŒLinux æœƒå…¶æ¸…ç©ºæª”æ¡ˆå¾Œå†è¼¸å…¥ï¼Œè¡“èªå« truncationï¼Œå¦‚æœä½ ä¸æƒ³è¦åŸæœ¬æª”æ¡ˆçš„è³‡æ–™è¢«æ¸…ç©ºï¼Œå‰‡å¯ä»¥ç”¨ cat &gt;&gt; output.txt, &gt;&gt; ç‚º appending çš„ç¬¦è™ŸStandard Error ç¯„ä¾‹: cat -k bla 2&gt; error.txtStandard Output å’Œ Error éƒ½è¼¸å‡º: cat 1&gt; output.txt 2&gt;error.txtStandard Input: æˆ‘å€‘è®€å–ä¸€å€‹æª”æ¡ˆçš„è³‡æ–™ç•¶ä½œ standard input, cat 0&lt; inpput.txt æˆ–æ˜¯ cat &lt; inpput.txt ç·´ç¿’: åˆ©ç”¨ cat command è®€å–æŸå€‹æª”æ¡ˆçš„å…§å®¹å¾Œå¯«å…¥ hello.txtç­”æ¡ˆ: cat &lt; input.txt &gt; hello.txt Pipingåˆ©ç”¨ | ç¬¦è™Ÿå¯ä»¥å°‡ command çš„ standard output è½‰ç‚ºä¸‹å€‹ command çš„ standard inputï¼Œä¸¦ä¸”å¯ä»¥ä¸æ–·æ¥ä¸‹å» èªæ³•: command1 [-options] [args] | command2 [-options] [args] | ... Q: å¦‚æœæˆ‘å€‘ç¾åœ¨å¸Œæœ›å°‡ date æŒ‡ä»¤çš„ç¬¬ä¸€å€‹æ¬„ä½çš„å€¼ï¼Œè©²æ€éº¼åšå‘¢ï¼Ÿ åˆ©ç”¨ redirection: å°‡ date æŒ‡ä»¤çš„ output å­˜åœ¨ date.txt: date &gt; date.txt cut æŒ‡ä»¤è®€å– date.txt å¾Œå†å–ç¬¬ä¸€å€‹æ¬„ä½: cut &lt; date.txt -d &quot; &quot; -f 1 åˆ©ç”¨ Piping: å°‡ date çš„ standard output è½‰ç‚º cut standard input ç„¶å¾ŒåŸ·è¡Œ:date | cut -d &quot; &quot; -f 1 tee æŒ‡ä»¤ç•¶æˆ‘å€‘å¸Œæœ›æŒ‡ä»¤çš„è¼¸å‡ºå¯ä»¥åŒæ™‚ç”¢ç”Ÿæª”æ¡ˆè·Ÿè®Šç‚ºä¸‹å€‹æŒ‡ä»¤çš„è¼¸å…¥æ™‚ï¼Œæˆ‘å€‘å¯ä»¥åˆ©ç”¨ tee æŒ‡ä»¤ï¼Œtee æŒ‡ä»¤å°±åƒå¤šäº†ä¸€å€‹å‡ºå£çš„æ°´ç®¡Q: å¦‚æœæˆ‘å€‘æƒ³ date å°‡å®Œæ•´çš„æ—¥æœŸå¯«å…¥ full_date.txt åŒæ™‚å–å¾— date è¼¸å‡ºçš„ç¬¬ä¸€å€‹æ¬„ä½ï¼ŒæŒ‡ä»¤è©²æ€éº¼å¯«ï¼ŸA: date | tee full_date.txt | cut -d &quot; &quot; -f 1 xargsæŸäº›æŒ‡ä»¤ä¸æ¥å— standard inputï¼Œåªæ¥å— command args, åƒæ˜¯ echo æŒ‡ä»¤ï¼Œä½†æˆ‘å€‘å¯ä»¥ä½¿ç”¨ xargs ä¾†æ¥å‰é¢æŒ‡ä»¤ piping éä¾†çš„ standard input è½‰æ›æˆ command argsï¼Œçµ¦ echo æŒ‡ä»¤ç•¶åƒæ•¸ ex: date | xargs echo","link":"/2021/07/26/Linux-Command-%E5%85%A5%E9%96%80-%E4%BA%8C/"},{"title":"Linux | Understand Permissions","text":"Unix or Unux-like system like mac or linux allow multiple users in a single machine.As regular users, we donâ€™t have permission to write or even read every file on the machine.For example, if i try to read the file /etc/sudoers using cat . I get a â€œpermission deniedâ€ message. Groups On unix systems, a single user may be the owner of files and directories, meaning that they have control over their access. Additionally, users can belong to groups which are given access to particular files and folders by their owners. File Type The very first charater indicates the type of the file. Some of the more common types and their corresponding attributes are: -: regular file d: directory c: character special file I: symbolic link Understand Permissons permission: owner, group, world(anyone else) Permissions Character Effect On Files Effect On Directions r file can read directoryâ€™s content can be listed w file can be modified directoryâ€™s contents can be modified (create new files, rename files/folders) but only if the executable attribute is also set x file can be treated as a program be executed allows a directory to be entered or â€œcdâ€ed into - file cannot be read, modified or executed depending on the location of the - character directory contents cannot","link":"/2021/07/27/Understand-Linux-Permissions/"},{"title":"Linux | Alter Permissions","text":"chmodTo change the permissions of a file or directory, we can use the chmod command (change mode). To use chmod to alter permissions, we need to tell it: Who we are changing permission for? What change are we making? Adding? Removing? Which permissions are we setting? chmod mode file who u: user(the owner of the file) g: group(members of the group the file belongs to) o: other(the â€œworldâ€) a: all of the above what -: removes the permission +: grants the permission =: set a permission and removes others which r: the read permission w: the write permission x: the execute permission ExampleAdd write permissions to the group chmod g+w file.txt Remove write permissions from all chmod a-w file.txt Add executable permissions for owner chmod u+x file.txt Set permissions to read ONLY for all chmod a=r file.txt Add permissions to read and executable to the file chmod u+wx happy.txt chmod Octals (base 8)chmod also supports another way of representing permission patterns: octal numbers(base 8). Each digit in an octal number represents 3 binary digits. Octal Binary File Mode 0 000 â€” 1 001 â€“x 2 010 -w- 3 011 -wx 4 100 râ€“ 5 101 r-x 6 110 rw- 7 111 rwx ExampleQ: Alter the file permissions to user: rw_ group: r__ other: r__ A: User Group Other Octal 6 4 4 Binary 110 100 100 Permissions rw_ r__ r__ chmod 644 file.txt Change Identity (su command)We can use the su command to start a shell as another user within our shell session. change the currnet shell user to â€œkittyâ€NOTE: - or --login option will change the current directory, it is the recommanded option to prevent side effects caused by mixing environments. su - kitty using exit command to exit the enviroment of the subsitube user. Root UserThe root user can run any command and access any file on the machine, regardless of the fileâ€™s actual owner. Based on the reason above, the root user could easily damage the system by running wrong command. Therefore, Ubuntu locks the root user by default. Using The Sudo CommandEven if the root user is locked by default, we can still run specific commands as the root user by using the sudo command. Chaning ownwership (Chown command)The chown command is used to change the owner and/or the group owner of a specific file or directory. ExampleMake â€œkevinâ€ the owner of file.tx sudo chown kevin file.txt Make â€œtest_groupâ€ as the group owner of file.txt chown :test_group file.txt","link":"/2021/07/28/Linux-Alter-Permissions/"},{"title":"Python åŸºç¤èªæ³•","text":"æ­¤ç¯‡æ˜¯é›†çµ Python \b\bæ‰€æœ‰çš„åŸºç¤èªæ³•å…§å®¹ï¼Œæˆ‘å°‡æ­¤ç¯‡ç•¶ä½œå­¸ç¿’ç­†è¨˜ï¼Œéœ€è¦ç”¨åˆ°æ™‚æ‰å›ä¾†è¤‡ç¿’ï¼Œ\bä½†æœªè¦†è“‹åˆ° List Unpacking çš„ç”¨æ³•ï¼Œé—œæ–¼ List Unpacking çš„ä½¿ç”¨æ–¹å¼å¯ä»¥åƒè€ƒ Mike çš„é€™ç¯‡æ–‡ç«  Python Unpackingå¯¦ç”¨æŠ€å·§åˆ†äº« Data Type int float bool str list: å‹•æ…‹çš„ Arrayï¼Œ Javascript Array é¡ä¼¼ tuple: å¯ä»¥æƒ³æˆæ˜¯ immuable çš„ listmy_tuple = (1, 2, 3) set: collection of uniqe valuesmy_set = {1, 2, 3, 4, 5} dict: Javascript çš„ Object, Java çš„ HashMap Ternary Expressionis_lisenced = Trueword = \"I can sense that lisence in you\" if is_lisenced else \"get out\" Truthy and Falseyä»¥ä¸‹ç‚º Falsey å€¼ï¼Œ å…¶ä»–çš†è¦–ç‚º Truthy å€¼ None False 0 0.0 0j decimal.Decimal(0) fraction.Fraction(0, 1) [] - an empty list {} - an empty dict () - an empty tuple '' - an empty str b'' - an empty bytes set() - an empty set an empty range, like range(0) objects for which obj.__bool__() returns False obj.__len__() returns 0 is vs ==== æª¢æŸ¥å€¼æ˜¯å¦ç›¸åŒ, å¦‚æœéç›¸åŒçš„å‹åˆ¥ï¼Œpython æœƒè©¦è‘—è½‰å‹åˆ¥ print(True == 1) # True, pythonthon compare True == bool(1)print('' == 1) # Falseprint([] == 1) # Falseprint(10 == 10.0) # Trueprint([] == []) # True is æª¢æŸ¥è¨˜æ†¶é«”åœ°å€æ˜¯å¦ç›¸åŒ print(True == 1) # Falseprint('' == 1) # Falseprint([] == 1) # Falseprint(10 == 10.0) # Falseprint([] == []) # False for Loops and Iteratorfor item in 'Brian': print(item) Iterate Objectuser = { \"name\": \"Brain\", \"age\": 28, \"can_swim\": True}for item in user.items(): print(item) for key, value in user.items(): print(key, value) ç”¨ range()for item in range(100): print(item) å¦‚æœä½ ä¸éœ€è¦ç”¨åƒæ•¸çš„è©±: for _ in range(100): print('haha') while loopi = 0while i &lt; 50: print(i) i += 1else: print('Done with all the work') å¦‚æœç”¨ Break çš„è©±å°±ä¸æœƒè·‘ else çš„ç¨‹å¼ i = 0while i &lt; 50: print(i) i += 1 breakelse: print('Done with all the work') continueåœ¨è¿´åœˆè£¡ç”¨ continue, å°±æœƒç•¥éè¿´åœˆè£¡ continue ä»¥å¾Œçš„ç¨‹å¼ï¼Œç›´æ¥è·‘ä¸‹ä¸€å€‹è¿´åœˆ my_list = [1, 2, 3]for item in my_list: print('haha') continue print(item) # æ­¤è¡Œæ°¸é ä¸æœƒè·‘ i = 0while i &lt;len(my_list): print(my_list[i]) i += 1 continue print(i) # æ­¤è¡Œæ°¸é ä¸æœƒè·‘ Function*args è·Ÿ *kwargs*_args:_ å°‡æ‰€æœ‰çš„ arugements è½‰ç‚º tuple def super_func(*args): print(args) # (1, 2, 3, 4, 5) super_func(1, 2, 3, 4, 5) *_kwargs:_ å°‡æ‰€æœ‰çš„ arguments è½‰ç‚º dict def super_func(**kwargs): print(kwargs) # { name: \"Brian\", age: 27 } super_func(name='Brian', age=27) åŒæ™‚ä½¿ç”¨ def super_func(*args, **kwargs): print(args) # (1, 2, 3) print(kwargs) # { name: \"Brian\", age: 27 } super_func(1, 2, 3, name='Brian', age=27) å¦‚æœè¦ä½¿ç”¨å¤šç¨®ä¸åŒçš„åƒæ•¸é †åº: params, *args, default params, **kwargs Function Docstringå¯ä»¥åˆ©ç”¨ docstring å¹« function é€²è¡Œè¨»è§£ def test(): ''' Info: this function tests and prints param a string ''' print('Hello world') Walrus OperatorBefore: a = 'Helloooooooooooo'if (len(a) &gt; 10): print(f\"Too long {len(a)} letters\") After: a = 'Helloooooooooooo'if ((n := len(a)) &gt; 10): print(f\"Too long {n} letters\") è®Šæ•¸ Scopeé †åºç‚º æ˜¯å¦ç‚º local è®Šæ•¸ æ˜¯å¦ç‚º parent å±¤ local è®Šæ•¸ æ˜¯å¦ç‚º global è®Šæ•¸ æ˜¯å¦ç‚ºå…§å»º method globalå¦‚æœè¦åœ¨ function è£¡, ç”¨ global çš„è®Šæ•¸, å‰‡éœ€è¦ç”¨ global keyword totoal = 0def count(): global total total += 1 return total print(count()) ä½†ä¸æ¨è–¦é€™éº¼åšï¼Œå¯ä»¥ç›´æ¥å°‡ global çš„è®Šæ•¸ä¸Ÿé€² function è£¡é–±è®€æ€§è¼ƒå¥½ nonlocalåœ¨ function è£¡ä½¿ç”¨ parent function çš„è®Šæ•¸, å‰‡éœ€è¦ç”¨ nonlocal keyword def outter(): x = \"local\" def inner(): nonlocal x x = \"nonlocal\" print(x) inner() print(\"outer:\", x)outer() classclass Player(): # constructor def __init__(self, name): self.name = name # method, æ‰€æœ‰çš„ method ç¬¬ä¸€å€‹åƒæ•¸éƒ½æ˜¯ self def run (self): print('run') @classmethod, @staticmethodç”¨ä¾†æ–°å¢ class æœ¬èº«çš„ method, ä¸éœ€è¦ instantiate å°±å¯ä»¥ä½¿ç”¨ èˆ‡ä¸€èˆ¬ method ä¸åŒï¼Œ@classmethod çš„ç¬¬ä¸€å€‹åƒæ•¸æ˜¯è‡ªå·±æœ¬èº«çš„ class, @staticmethod å‰‡æ²’æœ‰ä»»ä½•é è¨­åƒæ•¸ class Player(): def __init__(self, name): self.name = name @classmethod def sum(cls, num1, num2): return num1+num2 @staticmethod def sum2(num1, num2): return num1+num2 Inheritanceå­ class éœ€è¦åˆ©ç”¨è©² Classåç¨±.__init__() æˆ–æ˜¯ super().__init__() å°‡çˆ¶ class init éœ€è¦çš„ç›´å‚³å…¥Classåç¨±.__init__(): ç¬¬ä¸€å€‹åƒæ•¸è¦å‚³å…¥ self class Person(): def __init__(self, name, age): self.name = name self.age = age def greeting(self): print(f'Hello, my name is {self.name} and i am {self.age} years old')class Wizard(Person): def __init__(self, name, age, power): Person.__init__(self, name, age) self.power = power super().__init__(): ä¸éœ€å‚³å…¥ self class Person(): def __init__(self, name, age): self.name = name self.age = age def greeting(self): print(f'Hello, my name is {self.name} and i am {self.age} years old')class Wizard(Person): def __init__(self, name, age, power): super().__init__(name, age) self.power = power def attack(self): print(f'attacking with power of {self.power}') Multiple Inheritanceclass Wizard: def __init__(self, name, power): self.name = name self.power = power def magic_attack(self): print(f'{self.name} shoot the magic fire ball with {self.power} damage') class Archer: def __init__(self, name, arrow_count): self.name = name self.arrow_count = arrow_count def shoot_arrow(self): print(f'{self.name} shoot {self.arrow_count} arrows')class HybridMan(Wizard, Archer): def __init__(self, name, power, arrow_count): Wizard.__init__(self, name, power) Archer.__init__(self, name, arrow_count) super_man = HybridMan('Super Man', 10000, 500)super_man.magic_attack()super_man.shoot_arrow() MRO - Method Resolution Orderclass A: num = 10class B(A): passclass C(A): num = 1class D(B, C): pass print(D.num) # 1 # ç¹¼æ‰¿åœ– A / \\ B C \\ / D # method åŸ·è¡Œé †åºç‚º D -&gt; B -&gt; C -&gt; A# å¯ä»¥ä½¿ç”¨ .mro() å¾—åˆ°åŸ·è¡Œé †åº D.mro() Dunder Methodspython è£¡æ‰€æœ‰æ±è¥¿éƒ½æ˜¯ object, ç•¶æˆ‘å€‘åœ¨å‰µå»ºä¸€å€‹ç‰©ä»¶æ™‚ï¼Œå°±æœƒç¹¼æ‰¿åº•å±¤ object çš„ methods, æ‰€æœ‰ä½ çœ‹åˆ°çš„ __xxx__ å±¬æ€§éƒ½æ˜¯ç¹¼æ‰¿åº•å±¤ object ä¾†çš„ method, ä½†æˆ‘å€‘ä¹Ÿå¯ä»¥é€šéè¦†å¯«å»é‡æ–°å¯¦ä½œé€™äº› method å‡è¨­æˆ‘å€‘æƒ³è¦è¦†å¯« __str__ method class Toy(): def __init__(self, color): self.color = color def __str__(self): return f'{self.color}' toy = Toy('Yellow')print(toy.__str__()) # yellowprint(str(toy)) # yellow __name__: æª”æ¡ˆ(æ¨¡çµ„)çš„åç¨±, å¦‚æœæ˜¯åŸ·è¡Œçš„æª”æ¡ˆå‰‡æ˜¯ __main__ functional programmingBuild in methodsmap my_list = [1, 2, 3]def multiply(num): return num * 2mapObject = map(multiply, my_list)new_list = list(mapObject) filter test_list = [1, 2, 3]def is_odd(num): return num % 2 != 0odd_numbers = list(filter(is_odd, test_list)) zip test_list = [1, 2, 3]test_list2 = [\"David\", \"Amy\", \"John\"]def is_odd(num): return num % 2 != 0zipped_list = list(zip(test_list, test_list2))print(zipped_list)# ------------------# output:# [(1, 'David'), (2, 'Amy'), (3, 'John')]# ------------------ reduce from functools import reducemy_list = [1, 2 ,3]def accumulator(acc, number): return acc + numberprint(reduce(accumulator, my_list, 0)) Lambda èªæ³•: lambda param: action(param) test_list = [1, 2, 3,]# mapmap(lambda num: num * 2, my_list)# filterlist(filter(lambda num: num % 2 != 0, my_list))# reducereduce(lambda acc, num: acc + num, my_list, 0)# List Sortinga = [(0,2), (4,3), (9,9), (10, -1)]a.sort(key=lambda x: x[1])print(a) list, set, dictionary comprehensioné€™æ˜¯ä¸€å€‹åªæœ‰ pythonthon ç¨æœ‰çš„èªæ³•ç³–before: my_list = []for char in \"Heloo\": my_list.append(char) after: my_list = [char for char in 'hello'] å…¶ä»–ç¯„ä¾‹: my_list2 = [num for num in range(0, 200)] å¦‚æœæˆ‘æƒ³è®“ output çš„æ•¸å­—éƒ½ä¹˜2 my_list2 = [num*2 for num in range(0, 200)] åŠ ä¸Š condition # **æ˜¯ power çš„æ„æ€# if å¾Œé¢æ˜¯çµæœç¯©é¸çš„æ¢ä»¶my_list2 = [num**2 for num in range(0, 100) if num % 2 == 0] Dictionary Example: my_dict = {num:num*2 for num in [1,2,3]}print(my_dict)#--------------# output: {1: 2, 2: 4, 3: 6}#-------------- simple_dict = { 'a': 1, 'b': 2}my_dict = {key:value**2 for key, value in simple_dict.items()}print(my_dict)#--------------# output: { 'a': 1, 'b': 4 }#-------------- åŠ ä¸Š condition simple_dict = { 'a': 1, 'b': 2}my_dict = {k:v**2 for k,v in simple_dict.items()if v%2 == 0}print(my_dict)#--------------# output: { 'b': 4 }#-------------- DecoratorHigher Order functionä»¥ä¸‹å…©ç¨®éƒ½ç®—æ˜¯ higher order function åƒæ•¸ç‚º function def greet(func): func() è¿”å› function def greet(): def func(): return 5 return func Decorator function çš„æ ¼å¼åªè¦ç¬¦åˆä»¥ä¸‹æ ¼å¼å°±å¯ä»¥ç•¶ decorator function, æ‰€ä»¥äº‹å¯¦ä¸Š decorator åªæ˜¯ higher order function çš„èªæ³•ç³– def my_decorator(func): def wrap_func(): print(\"é–‹å§‹åŸ·è¡Œ~\") func() print(\"åŸ·è¡ŒæˆåŠŸ ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€\") return wrap_func ä½¿ç”¨: @my_decoratordef hello(): print(\"æˆ‘æ˜¯ä¸€å€‹ function\")hello()#-----------# output: # é–‹å§‹åŸ·è¡Œ~# æˆ‘æ˜¯ä¸€å€‹ function# åŸ·è¡ŒæˆåŠŸ ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€#----------- ä»¥ä¸‹å…©å€‹èªæ³•ç›¸ç­‰Higher Order Function ç‰ˆï¼š def hello(): print(\"æˆ‘æ˜¯ä¸€å€‹ function\") wrap_func = my_decorator(hello)wrap_func() Decorator ç‰ˆ: @my_decoratordef hello(): print(\"æˆ‘æ˜¯ä¸€å€‹ function\")hello() å‚³åƒæ•¸å‚³å–®å€‹åƒæ•¸ def my_decorator(func): def wrap_func(param): print(\"----------\") func(param) print(\"----------\") return wrap_func å‚³å¤šå€‹åƒæ•¸: åˆ©ç”¨ list unpacking def my_decorator(func): def wrap_func(*args, **kwargs): print(\"----------\") func(*args, **kwargs) print(\"----------\") return wrap_func Error HandlingBuilt-In Error èªæ³• while(True): try: age = int(input('What is your age?')) 10/age except: print('Please enter a number') else: print('Thank you!') break æŠ“ç‰¹å®š exceptioné€™é‚Šæˆ‘å€‘æƒ³è¦æŠ“ä½¿ç”¨è€…æ‰“ 0 çš„æ™‚å€™çš„ï¼Œ10/0 ç™¼ç”Ÿçš„éŒ¯èª¤, while(True): try: age = int(input('What is your age?')) 10/age except ValueError: print('Please enter a number') except ZeroDivisionError: print('Please enter age higher than 0') else: print('Thank you!') break ä½¿ç”¨ Error ç‰©ä»¶ def sum(num1, num2): try: return num1 + num2 except TypeError as err: print(f'Please enter numbers {err}') ä¸€æ¬¡æŠ“å–å…©ç¨®éŒ¯èª¤ def sum(num1, num2): try: return num1/num2 except (TypeError, ZeroDivisionError) as err: print(f'Error: {err}') åˆ©ç”¨ finally keyword while(True): try: age = int(input('What is your age?')) except ValueError: print('Please enter a number') except ZeroDivisionError: print('Please enter age higher than 0') else: print('Thank you!') break finally: print('ok, i am finally done') ç”¨ raise keywordä¸»å‹•ç™¼å‡º Erroræœ‰æ™‚å€™æˆ‘å€‘æƒ³è¦é‡å°ç‰¹å®šé‚è¼¯ä¸»å‹•ç™¼èµ·éŒ¯èª¤ï¼Œé€™æ™‚å€™æˆ‘å€‘å°±å¯ä»¥ç”¨ raise keyword def sum(num1, num2): try: number = num1/num2 if (number &lt; 0): raise ValueError('The number should be positive') return number except (TypeError, ZeroDivisionError) as err: print(f'Error: {err}') Generatorèªæ³•Example 01 def generator_function(num): for i in range(num): yield i*2 generator = generator_function(100)print(next(generator)) # output: 0print(next(generator)) # output: 2print(next(generator)) # output: 4 Example 02 def gen_func(num): for i in range(num): yield ifor i in gen_func(10): print(i) Moduleså‡è¨­æˆ‘ç¾åœ¨é™¤äº† main.py ä»¥å¤–é‚„ä»¥ä¸€å€‹ utilities.py çš„æª”æ¡ˆåœ¨åŒä¸€å€‹æª”æ¡ˆå¤¾import æ•´å€‹ file import utilitiesnum = utilies.mutiply(2, 3) import å€‹åˆ¥è®Šæ•¸å’Œ methodsæ³¨æ„ï¼šå¦‚æœ import çš„ method èˆ‡ built in method æ’å, æœƒåŸ·è¡Œ import çš„ method, æˆ–æ˜¯å¯ä»¥ç”¨ as keyword å°‡ import çš„ method æ”¹å from utilities import multiply, dividenum = multiply(2,3) å¦‚æœè¦ import æª”æ¡ˆå¤¾è£¡é¢çš„æª”æ¡ˆï¼Œpython æœƒæŠŠæª”æ¡ˆå¤¾ç•¶ä½œæ˜¯ package # import æ•´å€‹æ¨¡çµ„import folder_name.file_name# import methodfrom folder_name.file_name import the_method","link":"/2021/07/29/Python-Basic/"},{"title":"Python æª”æ¡ˆè®€å¯«(File I/O)","text":"my_file = open('your_file.txt')text = my_file.read()print(text) # hello worldmy_file.close() æ¨è–¦ file i/o å¯«æ³•, ä½¿ç”¨ with å°±ä¸éœ€è¦ä½¿ç”¨ file.close() ä¾†é—œé–‰æª”æ¡ˆ with open('your_file.text') as my_file: text = my_file.read() print(text) å¯«å…¥open ç¬¬äºŒå€‹åƒæ•¸æ˜¯è®€å¯«æ¨¡å¼, read:r write:w appendï¼ša create: x read and write: r+ (å¯«å…¥çš„æ–¹å¼ç‚º Append, å¦‚æœä½ è¦è®€åŠ ä¸Šè¦†å¯«æª”æ¡ˆï¼Œå°±åªèƒ½å…ˆç”¨ r mode è®€å–å†ç”¨ w mode å¯«å…¥) with open('test.txt', mode = 'w') as my_file: text = my_file.write('hello, i am brain') print(text) éŒ¯èª¤è™•ç†try: with open('test.txt', mode = 'r') as my_file: print(my_file.read())except FileNotFoundError as err: print('file does not exist')except IOError as err: print('IO error') raise err ç·´ç¿’åˆ©ç”¨ translate å¥—ä»¶ï¼Œè®€å–è‹±æ–‡æª”æ¡ˆå¾Œç¿»è­¯æˆä¸­æ–‡, å¯«å…¥å¦ä¸€å€‹æª”æ¡ˆ from translate import Translatortranslation = ''try: with open('test.txt', 'r') as file: text = file.read() translator = Translator(to_lang=\"zh\") translation = translator.translate(text) with open('translation.txt', 'w') as my_file2: my_file2.write(translation)except (IOError, FileNotFoundError) as err: print(err)","link":"/2021/07/30/Python-%E6%AA%94%E6%A1%88%E8%AE%80%E5%AF%AB-I-O/"},{"title":"React Native Beacon åŠŸèƒ½é–‹ç™¼","text":"ä»€éº¼æ˜¯ä½åŠŸè€—è—èŠ½ä½åŠŸè€—è—èŠ½æ˜¯è—èŠ½ 4.0 å¾Œå› æ‡‰ç‰©è¯ç¶²(IOT)è¶¨å‹¢æ‰€ç™¼å±•å‡ºçš„è—èŠ½æŠ€è¡“ï¼ŒæŠ€è¡“ç‰¹é»æ˜¯ä½¿ç”¨å¾ˆä½çš„èƒ½æºæ¶ˆè€—é»å°é»çš„å‚³è¼¸å°‘é‡çš„è³‡æ–™ï¼Œä¸€èˆ¬ç”¨åœ¨é‹å‹•è¿½è¹¤è£ç½®ã€æ™ºèƒ½æ‰‹éŒ¶ã€å¥åº·è¿½è¹¤ã€å®¶åº­è‡ªå‹•åŒ–â€¦ç­‰ç­‰ï¼Œä½åŠŸè€—è—èŠ½ä¸€èˆ¬åˆ†ç‚ºå…©ç¨®è£ç½®: Peripheral Device(å¤–åœè£ç½®): ä¸€èˆ¬ç‚ºæ™ºæ…§å‹ç©¿æˆ´è£ç½® Central Device(ä¸­å¿ƒè£ç½®): ä¸€èˆ¬æ˜¯æ™ºæ…§å‹æ‰‹æ©Ÿï¼Œä¸€èˆ¬ç‚ºè¨Šè™Ÿçš„æ¥æ”¶æ–¹ ä½åŠŸè€—è—ç‰™å·¥ä½œåŸç†å¤–åœè£ç½®åœ¨æœªè¢«é€£æ¥æ™‚æœƒä¸æ–·å°å¤–å»£æ’­(Advertisements), ä¸­å¿ƒè£ç½®åœ¨æ¥æ”¶åˆ°å»£æ’­å…§å®¹å¾Œå¯ä»¥è‡ªè¡Œæ±ºå®šè¦ä¸è¦é€£æ¥ What is BLE? (2020) | Bluetooth Low Energy | Learn Technology in 5 Minutes ä»€éº¼æ˜¯ Beaconåˆ©ç”¨ ble å¤–åœè£ç½®çš„å»£æ’­ç‰¹æ€§ï¼Œå»£æ’­ç‰¹å®šæ ¼å¼è¨Šæ¯çš„ä½åŠŸè€—è—èŠ½è£ç½®ï¼Œå¯ä»¥è®“ä¸­å¿ƒè£ç½®åœ¨è½åˆ°æ­¤ç¨®å»£æ’­è¨Šæ¯æ™‚åŸ·è¡Œç›¸å°æ‡‰æŒ‡ä»¤ï¼Œex: æ¨æ’­å»£å‘Šï¼Œè·³å‡ºè³‡è¨Šå½ˆçª—ç­‰ï¼Œç›®å‰å¸‚å ´ä¸»æµçš„ Beacon å”è­°æœ‰ iBeacon(Apple), Eddystone(Google), AltBeacon(Open Source), ä¸‰è€…ä¸­æœ€ç†±é–€çš„å‰‡æ˜¯ iBeacon Beacon ä½¿ç”¨æ¡ˆä¾‹ é—œæ–¼ iBeaconiBeacon ç‚º Apple åœ¨ 2013 WWDC ä¸Šç™¼å¸ƒçš„ BLE çš„æ‡‰ç”¨æŠ€è¡“ï¼Œå…¶å°‡ BLE å»£æ’­è³‡æ–™æ ¼å¼å®šç‚º ç¯„ä¾‹ï¼š åŒä¸€å®¶å…¬å¸ä½¿ç”¨ä¸€å€‹UUIDï¼Œä¾ç…§åŸå¸‚ä¸åŒç”¨ä¸åŒçš„Major valueï¼Œä¾ç…§å•†å“ä¸åŒç”¨ä¸åŒçš„Minor Value åè©è§£é‡‹ Region: Apple å°‡ beacon ä¿¡è™Ÿç¯„åœèªå®šç‚ºä¸€å€‹ Geofenceï¼ˆè™›æ“¬çš„åœ°ç†åœæ¬„æˆ–å€å¡Šï¼‰, ç”±ä¸Šè¿°çš„ uuid, major, minor å’Œ identifier (é€™å€‹ region çš„åç¨± ex: 2 æ¨“è¾¦å…¬å®¤)ä¾†å®šç¾©, å®šç¾© uuid å’Œ identifier æ˜¯å¿…å¡«ï¼Œmajor å’Œ minor å¯ä»¥ä¾ç…§éœ€æ±‚é¸å¡«, ä¸€å€‹ App æœ€å¤šä¸€æ¬¡åŒæ™‚åµæ¸¬ 20 å€‹ Region Ranging: è£ç½®åœ¨åµæ¸¬èˆ‡ beacon è·é›¢çš„è¡Œç‚ºï¼Œåªèƒ½åœ¨ App å‰æ™¯ä½¿ç”¨ è§¸ç™¼ eventName: didRangeBeacons æ‰€éœ€æ¬Šé™ï¼šLocation When In Use Usage Monitoring: ç›£æ¸¬æ‰‹æ©Ÿæ˜¯å¦é€²åˆ° Region æˆ–é›¢é–‹ Regionï¼Œèƒ½åœ¨å‰æ™¯ã€èƒŒæ™¯ã€æœªæ‰“é–‹ App çš„æƒ…å¢ƒä¸‹ä½¿ç”¨ è§¸ç™¼ eventName: didEnterRegion, didExitRegion æ‰€éœ€æ¬Šé™ï¼šLocation Always Usage æ³¨æ„ï¼šiOS é è¨­èƒŒæ™¯åµæ¸¬åªæœƒæœ‰å¹¾ç§’çš„æ™‚é–“ä¾†è™•ç† Android æ˜¯å¦ä¹Ÿæ”¯æ´ iBeaconæ˜¯çš„ï¼ŒiBeacon åªæ˜¯ä¸€ç¨® BLE å»£æ’­çš„è³‡æ–™æ ¼å¼ï¼ŒAndroid å¯ä»¥åµæ¸¬æ­¤æ ¼å¼çš„è³‡æ–™å¾Œï¼Œè®“ App åšå°æ‡‰è™•ç†ï¼Œç›®å‰å·²æœ‰ Android Library è®“ Android å¯ä»¥åƒ iOS ä¸€æ¨£é€²è¡Œ Ranging å’Œ Monitoring Android éœ€è¦åœ°é»æ¬Šé™ä¾†åµæ¸¬ beacon, è‹¥æœªé–‹å•Ÿæœƒæƒä¸åˆ° æ–°å¢ä»¥ä¸‹ permission åœ¨ AndroidManifest.xml // old version of Android&lt;uses-permission android:name=\"android.permission.ACCESS_COARSE_LOCATION\" /&gt;// SDK 29+&lt;uses-permission android:name=\"android.permission.ACCESS_FINE_LOCATION\" /&gt;&lt;uses-permission android:name=\"android.permission.ACCESS_BACKGROUND_LOCATION\" /&gt; React-Native ç›¸é—œçš„å¥—ä»¶react-native-beacons-manager æ˜¯ç¶­è­·å¹´ä»½ç›¸å°è¼ƒè¿‘çš„å¥—ä»¶ï¼Œä½†ç›®å‰å·²ç¶“ 3 å¹´å·¦å³æ²’æœ‰å†ç™¼å¸ƒæ–°ç‰ˆæœ¬ï¼Œç›®å‰æ˜¯ä½¿ç”¨ github ä¸Šæœ€æ–°çš„ git commit é»ä¾†åšå®‰è£ \"devDependencies\": { \"react-native-beacons-manager\": \"git://github.com/MacKentoch/react-native-beacons-manager.git#d118c87\", }, ç›®å‰å¯¦æ¸¬ç•¶ App åœ¨å‰æ™¯æ™‚ Ranging å’Œ Monitoring éƒ½èƒ½å¤ æ­£å¸¸é‹ä½œ åƒè€ƒæ–‡ä»¶èˆ‡å½±ç‰‡è—èŠ½ ä½ ä¸äº†è§£çš„ã€è—èŠ½ã€ï¼Œç¡¬æ ¸ç„¡ç·šæŠ€è¡“(ä¸Š) ä½ ä¸äº†è§£çš„ã€è—èŠ½ã€ï¼Œç¡¬æ ¸ç„¡ç·šæŠ€è¡“(ä¸‹) æ·ºè«‡ BLEï¼ˆBluetooth Low Energyä½åŠŸè€—è—ç‰™ï¼‰Androidã€iOS æ¦‚è¿° GATT è—èŠ½å‚³è¼¸ Beacon Get Started with Beacon(Android Official Document) How Beacon works? iBeacon. Itâ€™s a Trademark, Not a Technology. ESP32 #6: BLE / Bluetooth iBeacon implementation Understanding the different types of BLE Beacons Turning an iOS Device into an iBeacon Device How to scan iBeacon signals without specifying UUID? ibeaconèƒŒæ™¯åµæ¸¬æµç¨‹ Swift iBeacon App ç¨‹å¼è¨­è¨ˆ iBeacon åµæ¸¬ç¯„ä¾‹ - android client estimote api doc (æ­¤ Doc éå¸¸è§£é‡‹æ¸…æ¥š ï¼Œè«‹å„ªå…ˆé–±è®€) iBeacon Apple Docs Getting Started with iBeacon (æ­¤ç‚º Apple å®Œæ•´èªªæ˜ iBeacon é‹ä½œæ–¹å¼æ–‡ä»¶ï¼Œè«‹å„ªå…ˆé–±è®€) Determining the Proximity to an iBeacon Device Region Monitoring and iBeacon Ranging for Beacons FAQ å¯ä»¥æ”¹ Beacon çš„ UUID å—ï¼Ÿ å¯ä»¥ï¼Œä½†æ˜¯éœ€è¦ç¶“ç”±å» å•†æä¾›çš„ App æˆ– SDK Question reference: Stack Overflow , Apple Developer Forums","link":"/2021/09/29/React-Native-Beacon-%E5%8A%9F%E8%83%BD%E9%96%8B%E7%99%BC/"},{"title":"å¦‚ä½•åœ¨ React Native å°ˆæ¡ˆæ–°å¢ iOS Widgets","text":"React Native å°ˆæ¡ˆè¨­å®šæ–°å¢ widget extension ä¹‹å¾Œï¼Œå°ˆæ¡ˆæœƒç™¼ç”Ÿç„¡æ³• build çš„éŒ¯èª¤, è«‹åƒè€ƒæ­¤ issue: https://github.com/facebook/react-native/issues/29246 èª¿æ•´ swift ç‰ˆæœ¬ èª¿æ•´å®Œå¾Œè«‹æ–°å¢ä¸€å€‹ swift æª”ï¼ŒXcode æœƒè©¢å•ä½ æ˜¯å¦è¦åŠ å…¥ bridge-header æª”ä¾†è®“ Objective-c çš„ç¨‹å¼å¯ä»¥è®€ swift çš„ç¨‹å¼ï¼Œæ–°å¢å®Œæˆå¾Œï¼Œå°ˆæ¡ˆå°±å¯ä»¥æ­£å¸¸ compile äº† Widget å·¥ä½œåŸç†Widget ä¾ç…§ TimelineProvider æä¾›çš„ Snapshot/Placeholder å’Œ Timeline é€²è¡Œé¡¯ç¤ºèˆ‡æ›´æ–°ï¼Œåªè¦ Timeline æ›´æ–°ï¼ŒWidget å°±æœƒæ›´æ–° é è¨­é¡¯ç¤ºç•«é¢ (Snapshot/Placeholder)å·¥å…·åˆ—é¸æ“‡ Widget æ™‚ï¼Œé è¨­çš„ Widget é¡¯ç¤ºè³‡ Timeline entries(entry[]): æ¯æ™‚é–“é»éœ€è¦é¡¯ç¤ºçš„è³‡æ–™ entry: ç”± é¡¯ç¤ºæ™‚é–“ï¼ˆdateï¼‰å’Œå…¶ä»–è‡ªå®šç¾©è³‡æ–™çµ„æˆ Policy: æ›´æ–° Timeline çš„è¦å‰‡ Policy ç¨®é¡ï¼š atEnd: ç•¶ TimelineProvider æä¾› TimelineEntry ç‚ºé™£åˆ—çš„æœ€å¾Œä¸€å€‹æ™‚ï¼Œç³»çµ±å°‡æœƒè¦æ±‚æ–°çš„ Timelineã€‚ after(Date): ç•¶æŒ‡å®šçš„æ™‚é–“åˆ°ï¼Œå–å¾—æ–°çš„ Timeline never: ä¸å†æŠ“å–ï¼Œä½†å¯ä»¥åœ¨ App é–‹å•Ÿæ™‚ä¸»å‹• reload Timeline ä½¿ç”¨ atEnd policy çš„ Timeline ä½¿ç”¨ after policy çš„ Timeline åœ¨ App è£¡æ›´æ–° Timeline æ›´æ–°ä¸€å€‹ Widget çš„ Timeline WidgetCenter.shared.reloadTimelines(ofKind: \"com.brian.MyApp.My-Widget\") æ›´æ–°æ‰€æœ‰ Widget çš„ Timeline WidgetCenter.shared.reloadAllTimelines() Widget å¦‚ä½•èˆ‡ App å…±äº«è³‡æ–™AppGroupåœ¨ App Traget ä¸‹é¢é¸æ“‡ AppGroup, å¦‚æœæ²’æœ‰å»ºç«‹éï¼Œé»æ“Šä¸‹é¢ + è™Ÿå³å¯å»ºç«‹ é‡è¤‡ä¸Šé¢å‹•ä½œï¼Œå°‡ Widget ä¹ŸåŠ åˆ°ç›¸åŒåç¨±çš„ AppGroup, æˆ‘å€‘å°±å¯ä»¥è®€å–ã€å­˜å– UserDefault è£¡é¢çš„è³‡æ–™ let userDefaults = UserDefaults(suiteName: \"group.widget.store\");userDefaults?.setValue(value, forKey: \"text\" ) let userDefault = UserDefaults(suiteName: \"group.widget.store\")let text = userDefault?.value(forKey: \"text\") as? String ?? \"No text!!\" é»æ“Š Widget å¾Œå°é è‡³ç‰¹å®šé é¢ ï¼ˆDeep Linkingï¼‰å»ºç«‹ App urlType React Navgation è¨­å®šåœ¨ iOS å°ˆæ¡ˆè£¡çš„ AppDelegate.m åŠ å…¥ // Add the header at the top of the file:#import &lt;React/RCTLinkingManager.h&gt;// Add this above the `@end`:- (BOOL)application:(UIApplication *)app openURL:(NSURL *)url options:(NSDictionary&lt;UIApplicationOpenURLOptionsKey,id&gt; *)options{ return [RCTLinkingManager application:app openURL:url options:options];} è¨­å®š Deeplink prefix const SimpleApp = createAppContainer( createStackNavigator({ Home: { screen: HomeScreen }, Chat: { screen: ChatScreen, // :user æ˜¯ navigation çš„åƒæ•¸ path: 'chat/:user', }, );const prefix = 'mychat://';const MainApp = () =&gt; &lt;SimpleApp uriPrefix={prefix} /&gt;; è¨­å®šé»æ“Š Widget çš„ url var body: some View { VStack { // åˆ° Chat screen çš„æŒ‰éˆ• Link(destination: homeDeepLink) { Text(\"mychat://Chat/abc123\") } }.widgetURL(\"mychat://Home\") // é»æ“Š Widget å¤–æ¡†} Reference Article: åˆæ¢ Widget Extension in iOS 14 è®“ä¸åŒ App å…±äº«è³‡æ–™çš„ App Group WidgetKit(Official Doc) Perform a deeplink from SwiftUI widget on tap React Navigation Deep Link React Native bridge Swift Reference Video : Create SwiftUI Widgets in iOS 14 (Xcode 12, Swift, 2020) - iOS Development","link":"/2021/10/01/%E5%A6%82%E4%BD%95%E5%9C%A8-React-Native-%E5%B0%88%E6%A1%88%E6%96%B0%E5%A2%9E-iOS-Widgets/"},{"title":"Express ç­†è¨˜","text":"Express ConceptExpress is a bunch of middlewares works together Expresss Basic Routingconst express = require('express');const app = express();app.get('/register', (req, res) =&gt; { const body = req.body; const isSucceed = auth(body); if (isSucceed) { res.send('Register Successfully'); } else { res.status(443).sene('Authentication fail, unable to register'); }}); Apply Middlewareconst express = require('express')const app = express()function validateUser(req, res, next) { res.locals.validated = true; next()}// Apply the middleware to all method at route '/'app.use('/' ,validateUser)// Apply the middleware to \"GET\" method at route '/'app.get('/', validateUser)app.listen(3000) Use the built-in middleware express.json() : è§£æ conten-type æ˜¯ application/json çš„ request express.urlencoded() : è§£æ conten-type æ˜¯ application/x-www-form-urlencoded çš„ request , æœ€å¸¸è¦‹ POST æäº¤æ•¸æ“šçš„æ–¹å¼ï¼Œç€è¦½å™¨çš„åŸç”Ÿ è¡¨å–®ï¼Œå¦‚æœæ²’æœ‰è¨­ç½® enctype å±¬æ€§ï¼Œå°±æœƒä»¥é»˜èªä»¥æ­¤æ–¹å¼æäº¤æ•¸æ“š POST &lt;http://www.example.com&gt; HTTP/1.1Content-Type: application/x-www-form-urlencoded;charset=utf-8title=test&amp;sub%5B%5D=1&amp;sub%5B%5D=2&amp;sub%5B%5D=3 é€šéä½¿ç”¨ä»¥ä¸Šå…§ä»¶çš„ middleware, æˆ‘å€‘å°±å¯ä»¥åœ¨ res.body å¾—åˆ°å‰ç«¯ POST éä¾†çš„è³‡æ–™ const express = require('express')const app = express()app.use(express.json())app.use(express.urlencoding())app.post('/', (req, res, next) =&gt; { const data = res.body res.send('&lt;h1&gt;I got the data&lt;/h1&gt;')}) Servering static content express.static: serving specified folder const express = require('express')const app = express()// express.staic ä¹Ÿæ˜¯å…§å»ºçš„ middlewareapp.use(express.static('public')) ä½¿ç”¨ helmet å¢åŠ  server å®‰å…¨æ€§express æ–‡ä»¶ ä½¿ç”¨ Helemt npm install --save helmet Using View engineç†±é–€çš„ view engine é¸é …æœ‰ pug handlebars: npm i hbs mustache ejs ä½¿ç”¨å‰è¦ç”¨ npm å®‰è£ npm install pug --save const express = require('express')const app = express()// å‘ŠçŸ¥ express, æˆ‘å€‘è¦ä½¿ç”¨ pug åš view engineapp.set('view engine', 'pug');// å¯ä»¥è¨­å®š view template æ”¾åœ¨å“ªå€‹æª”æ¡ˆå¤¾ , é è¨­æœƒå»è®€åŒä¸€å±¤ç›®éŒ„çš„ views æª”æ¡ˆå¤¾// app.set('views', path.join(__dirname, 'views'))app.get('/', (res, res) =&gt; { res.render('index')}) å‚³å€¼åˆ° view template è£¡const express = require('express')const app = express()// å‘ŠçŸ¥ express, æˆ‘å€‘è¦ä½¿ç”¨ pug åš view engineapp.set('view engine', 'pug');app.get('/', (res, res) =&gt; { // å¾Œé¢çš„åƒæ•¸å…¶å¯¦éƒ½è¢«æ”¾åˆ° res.locals è£¡é¢äº† res.render('index', { title: 'Hey', message: 'Hello there!'});}) html head title= title body h1= message Handle cookiessetCookiesapp.post('/proccess_login', (req, res, next) =&gt; { const userName = req.body.userName; const password = req.body.password; if (password === correctPassword) { res.cookie('userName', userName); res.redirect('/welcome') } else { res.redirect('/login?msg=fail') }}) parseCookiesInstall cookie-parser npm install cookie-parser Apply cookie-parser as middleware var express = require('express')var cookieParser = require('cookie-parser')var app = express()app.use(cookieParser())app.get('/', function (req, res) { // Cookies that have not been signed console.log('Cookies: ', req.cookies) // Cookies that have been signed console.log('Signed Cookies: ', req.signedCookies)})app.listen(8080) è¨­å®š Cookie æ¡ˆä¾‹æˆ‘å€‘å¹³å¸¸åœ¨ç”¨ express æ™‚éƒ½æ˜¯å›å‚³ JSON æ ¼å¼ï¼Œæ‰€ä»¥ express æœƒç›´æ¥å¹«æˆ‘å€‘åœ¨ header å¸¶å…¥ Content-Type: 'application/json' ä½†æ˜¯å¦‚æœæˆ‘å€‘ä»Šå¤©è¦å›å‚³åœ–ç‰‡ï¼Œæˆ‘å€‘å°±å¯ä»¥è¨­å®š Content-Type ç‚º image/jpg æ ¼å¼ èˆ‰ä¾‹ï¼Œä»Šå¤©ä½¿ç”¨è€…è¦å–çš„è‡ªå·±çš„å¤§é ­è²¼åœ–ç‰‡ app.get('/user/me/avatar', auth, (req, res) =&gt; { res.set('Content-Type', 'image/jpg'); // user ç‰©ä»¶è£¡çš„ avatar å±¬æ€§æ˜¯çš„ base64 åœ–ç‰‡è³‡æ–™ res.send(req.user.avatar)}) Handle Cookie and Sessionåœ¨åšç”¨æˆ¶é©—è­‰æ™‚ï¼Œå¸¸ç”¨çš„é©—è­‰æ–¹å¼ä¹‹ä¸€æ˜¯ Session Based çš„é©—è­‰æ–¹å¼ï¼Œç°¡å–®ä¾†èªªå°±æ˜¯ç•¶ç”¨æˆ¶ç™»å…¥æˆåŠŸå¾Œï¼Œæˆ‘å€‘åœ¨å°‡ä¸€äº›é©—è­‰æˆåŠŸçš„è³‡æ–™æ”¾åœ¨å…¥ cookie è®“ä¹‹å¾Œçš„ client çš„ request éƒ½å¸¶è‘—é€™å€‹ cookie ä¾†è®“ server é€²è¡Œè¾¨è­˜ï¼Œå…¶ä¸­æœ‰å…©ç¨®åšæ³• å°‡ç”¨æˆ¶è³‡è¨ŠåŠ å¯†å¾Œæ”¾å…¥ cookie ä¸­, å¯ä½¿ç”¨ cookie-session å¥—ä»¶ä¾†å®Œæˆ åœ¨ server ç”¢ç”Ÿ session idï¼Œcookie ä¸­åªå¸¶ session id, ç”¨æˆ¶è³‡æ–™æœƒå­˜åœ¨å¦ä¸€å€‹ Server ç«¯çš„ DB (Redis), æ¯æ¬¡ request é€é session id ä¾†è¾¨è­˜ä½¿ç”¨è€…ï¼Œå¯ä»¥ç”¨ express-session å¥—ä»¶å®Œæˆ Pass data from URLQuery stringå‡è¨­å‰ç«¯ request url ç‚º: https://{your_domain_name}/product?productId=abc13&amp;productStatus=onSell app.get('/product', (req, res, next) =&gt; { const query = req.query; const productId = query.productId; const productStatus = query.productStatus;}) åœ¨ redirect æ™‚åŠ å…¥ params app.post('/proccess_login', (req, res, next) =&gt; { const userName = req.body.userName; const password = req.body.password; if (password === correctPassword) { res.cookie('userName', userName); res.redirect('/welcome') } else { res.redirect('/login?msg=fail') }}) WildCardså‡è¨­å‰ç«¯ request url ç‚º: https://{your_domain_name}/abc123/onSell app.get('/product/:productId/:productStatus:', (req, res, next) =&gt; { const productId = req.params.productId; const productStatus = req.params.productStatus;}) Pagination(åˆ†é ï¼‰é€é Query String çµ¦ API è¦ filter çš„æ¢ä»¶ GET /task?completed=true åªè¦å–å¾—å®Œæˆçš„ task GET /task?limit=10&amp;skip=10 åªæ‹¿ 10 ç­†ï¼Œä¸¦ä¸”è·³éå‰åç­† router.ger('/tasks', auth, async (req, res) =&gt; { const query = req.query}) Download filesapp.get('/statement', (req, res, next) =&gt; { // res.download ç¬¬äºŒå€‹åƒæ•¸å¯ä»¥æ”¹ä¸‹è¼‰æª”æ¡ˆçš„åç¨± res.download(path.join(__dirname, 'userStatements/BankStatement.png'))}) express å…¶å¯¦åªæ˜¯æŠŠ header æ”¹æ‰ï¼Œç„¶å¾Œå‘¼å« res.sendFile() å¦‚æœä½ åªè¦å°‡ header çš„ content-disposition æ”¹ç‚º attchment å¯ä»¥æ”¹ç”¨ res.attachment() app.get('/statement', (req, res, next) =&gt; { res.attachment(path.join(__dirname, 'userStatements/BankStatement.png'))}) æª”æ¡ˆä¸‹è¼‰éŒ¯èª¤è™•è£¡, é€šå¸¸éŒ¯èª¤ç™¼ç”Ÿæ™‚ response å¯èƒ½å·²ç¶“å›äº†ï¼Œæ‰€ä»¥ä¸èƒ½åœ¨ callback è£¡é¢å†é‡æ–°é€ä¸€æ¬¡, å¯ä»¥åˆ©ç”¨ res.headersSent æª¢æŸ¥ header æ˜¯å¦å·²é€å‡º app.get('/statement', (req, res, next) =&gt; { // res.download ç¬¬äºŒå€‹åƒæ•¸å¯ä»¥æ”¹ä¸‹è¼‰æª”æ¡ˆçš„åç¨± res.download( path.join(__dirname, 'userStatements/BankStatement.png'), 'BrianStatement', (error) =&gt; { if (error) { // res.headersSent is a bool, true if headers are already sent if (ï¼res.headersSent) { res.redirect('/download/error') } } } )}) Routerexpress æä¾›ï¼Œç”¨ä¾†æ‹†åˆ† route çš„ middleware const express = require('express');const { User } = require(\"../models\");const router = express.Router();// Create userrouter.post('/users', async (req, res) =&gt; { const user = new User(req.body); try { const savedUser = await user.save() res.status(201).send(savedUser); } catch (e) { res.status(400).send(e); }}) å‘ express è¨»å†Š Router const express = require('express')const app = exprss()const userRouter = require('./routes/userRouter')app.use(userRouter) Handle Http headers in ExpressSet headerapp.get('/', (req, res, next) =&gt; { const date = new Date(1969, 6, 20) res.set('Date', date) res.set('Context-Type', 'text/plain')}) Uploading files to Express with Multerä¸Šå‚³åœ–ç‰‡çš„æ ¼å¼æ˜¯ multipart/form-data å¯ä»¥ç”¨ multer ä¾† parse æª”æ¡ˆ å‡è¨­æˆ‘å€‘æœ‰ä¸€å€‹ form å¯ä»¥ä¸Šå‚³æª”æ¡ˆ &lt;html&gt; &lt;form method='post' action='formsub' enctype='multipart/form-data'&gt; &lt;input type='file' name=\"meme\" /&gt; &lt;/form&gt;&lt;/html&gt; ä¸Šå‚³å–®å€‹æª”æ¡ˆï¼Œæª”æ¡ˆåç¨±éœ€ç‚º meme const express = require('express')const multer = require('multer')const app = express()const upload = multer({ dest: 'public/images/uploads',});app.post('/formsub', upload.single('meme'),(req, res, next) =&gt; { const fileData = req.file;}) é™åˆ¶ Upload å¤§å°ã€æª”æ¡ˆé¡å‹ä½¿ç”¨ limits option å»é™åˆ¶ä¸Šå‚³æª”æ¡ˆå¤§å° const app = express();const multer = require('multer');const upload = multer({ dest: 'images', limits: { // 1 million bytes fileSize: 1000000, }});app.post('/upload', upload.single('upload'), (req, res) =&gt; { res.send();}); ä½¿ç”¨ fileFilter option multer æä¾›ä¸‰å€‹åƒæ•¸çµ¦ä½ ç”¨ fileFilter(req, file, cb) ç¬¬ä¸‰å€‹ cb åƒæ•¸æ¯”è¼ƒç‰¹åˆ¥ï¼Œ å¦‚æœä½ æ¥æ”¶é€™å€‹æª”æ¡ˆ: cb(null, true) å¦‚æœä½ æ‹’çµ•æ¥æ”¶é€™å€‹æª”æ¡ˆï¼š cb(null, false) å¦‚æœä½ æƒ³ throw éŒ¯èª¤çµ¦ clientï¼š cb(new Error('çµ¦ client çš„éŒ¯èª¤')) const app = express();const multer = require('multer');const upload = multer({ dest: 'images', limits: { // 1 million bytes fileSize: 1000000 }, fileFilter(req, file, cb) { if (!file.originalname.endsWith('.pdf')) { return cb(new Error('Please upload a PDF')) } cb(null, true); }}); ä½¿ç”¨ storage option å°‡è¨­å®šç‚º memoryStorage é€™å€‹é¸é …æœƒå­˜åœ¨è¨˜æ†¶é«”ä¸­çš„é¸é …è½‰ç‚º Buffer æ ¼å¼ï¼Œå¯ä»¥é€é req.file.buffer å–å¾—æª”æ¡ˆ buffer const storage = multer.memoryStorage()const upload = multer({ storage: storage })const upload = multer({ fileFilter(req, file, cb) { if (!file.originalname.endsWith('.pdf')) { return cb(new Error('Please upload a PDF')) } cb(null, true); }, storage});router.post('/users/me/avatar', auth, upload.single('avatar'), async (req, res) =&gt; { req.user.avatar = req.file.buffer; await req.user.save(); res.send('ok');}) Handling Express Errorså¦‚æœå‰é¢ middleware ä¸Ÿå‡ºéŒ¯èª¤ï¼Œæˆ‘å€‘å¯ä»¥æ–°å¢ Error Handling Middleware Error Handling Middleware, èˆ‡ä¸€èˆ¬ middleware çš„å·®åˆ¥æ˜¯ åªæœ‰åœ¨ call signature éƒ½æ˜¯å››å€‹åƒæ•¸çš„çš„æƒ…æ³ä¸‹ï¼Œexpress æ‰æœƒèªå®šé€™æ˜¯ error handling middleware,ä¸¦ä¸” call é€™å€‹ function ä»¥ä¸‹ä¾‹å­ï¼Œæˆ‘å€‘å…ˆåŠ ä¸Šä¸€å€‹ç›´æ¥ä¸ŸéŒ¯èª¤çš„ middleware åœ¨ route handler çš„å‰é¢, å¾Œé¢åŠ ä¸Šå†åŠ ä¸ŠError Handling Middleware const errorMiddleware = (req, res, next) =&gt; { throw new Error('From my middleware');}app.post('/upload', errorMiddleware, (req, res) =&gt; { res.send('ok')}, (err, req, res, next) =&gt; { res.status(500).send({ error: error.message })}) ç•¶å¯¦éš›åŸ·è¡Œå¯ä»¥ç™¼ç¾ç•¶ error è¢« throw å¾Œ ï¼Œroute handler è¢«è·³éäº†ï¼Œç›´æ¥åŸ·è¡Œ Error Handling Middleware å…¶ä»–ç´°ç¯€å’Œç”¨æ³•å¯ä»¥åƒè€ƒ express æ–‡ä»¶: éŒ¯èª¤è™•ç†","link":"/2021/10/05/Express-%E7%AD%86%E8%A8%98/"},{"title":"ä½¿ç”¨ apollo-studio èˆ‡ express-session ç„¡æ³• set-cookie å•é¡Œ","text":"Apollo Server 3 å¾Œï¼Œå°‡ graphql-playground æ”¹ç‚ºè‡ªå®¶çš„ apollo-studio, ç•¶ä½ ä¸€é–‹å•Ÿ http://localhost:{YOUR_DEV_PORT} æ™‚ï¼Œå®ƒæœƒä¸»å‹•å°é åˆ° https://studio.apollographql.com ä¸€é–‹å§‹ç”¨çš„æ™‚å€™ï¼Œè¦ºå¾—ç‰¹åˆ¥å¥½ç”¨ï¼Œapollo-studio çš„ auto-complete çš„åŠŸèƒ½æ¯” graphql-playground å¥½ç”¨è¨±å¤šï¼Œä½†æ˜¯åšåˆ°ç™»å…¥çš„åŠŸèƒ½æ™‚é‡åˆ°é€™å€‹å•é¡Œå›°æ“¾æˆ‘è¶…ä¹…ï¼Œæ˜æ˜å°±æœ‰çµ¦ set-cookie çš„ headerï¼Œä½†æ˜¯æ€éº¼æ¨£éƒ½æ‹¿ä¸åˆ° cookie å•é¡Œapollo-studio ç‚º https, cookie è£¡é¢å¿…é ˆè¦æœ‰ SameSite=None; Secure ä¸¦ä¸”å°‡ resonse header åŠ å…¥ä»¥ä¸‹å…©å€‹é¸é …æ‰èƒ½ set-cookie æˆåŠŸ Access-Control-Allow-Origin: https://studio.apollographql.comAccess-Control-Allow-Credentials: true å¦‚æœ set-cookie è£¡æ²’æœ‰ SameSite=None; Secure å³ä¾¿ res çš„ header æœ‰ set-cookie ä¹Ÿæœƒè¢« chrome ç›´æ¥ç•¥é æˆ‘å€‘å¯ä»¥ç”¨ä»¥ä¸‹ç¨‹å¼ï¼Œå°‡ SameSite=None; Secure åŠ å…¥ cookie res.cookie('testCookie', 'haha', { sameSite: 'none', secure: true }) ä½†æ˜¯ express-session çš„ cookie é¸é … secure é¸é …å¿…é ˆè¦æ˜¯ https é–‹å•Ÿçš„ç‹€æ…‹å®ƒæ‰æœƒå°‡ secure åŠ åˆ° cookie è£¡ï¼ŒåŸç¢¼è£¡é¢æœ‰ç‰¹åˆ¥å¯« function å»é©—è­‰æ˜¯å¦ç‚º https é€£ç·šï¼Œå¦‚æœsecure é¸é …çµ¦ true ä½†å»é https é€£ç·šï¼Œå®ƒå°±æœƒç›´æ¥ä¸ setCookie express-session æºç¢¼ function issecure(req, trustProxy) { // socket is https server if (req.connection &amp;&amp; req.connection.encrypted) { return true; } // do not trust proxy if (trustProxy === false) { return false; } // no explicit trust; try req.secure from express if (trustProxy !== true) { return req.secure === true } // read the proto from x-forwarded-proto header var header = req.headers['x-forwarded-proto'] || ''; var index = header.indexOf(','); var proto = index !== -1 ? header.substr(0, index).toLowerCase().trim() : header.toLowerCase().trim() return proto === 'https';} onHeaders(res, function(){ if (!req.session) { debug('no session'); return; } if (!shouldSetCookie(req)) { return; } // only send secure cookies via https if (req.session.cookie.secure &amp;&amp; !issecure(req, trustProxy)) { debug('not secured'); return; } if (!touched) { // touch session req.session.touch() touched = true } console.log(req.session.cookie.data) // set cookie setcookie(res, name, req.sessionID, secrets[0], req.session.cookie.data); }); è§£æ³•ä¸€ä½¿ç”¨ ApolloServerPluginLandingPageGraphQLPlayground pluginï¼Œç”¨èˆŠç‰ˆ apollo-server å…§å»º graphql æä¾›çš„ playgroundï¼Œè·‘åœ¨ local ç«¯å°±ä¸æœƒé‡åˆ°ä»¥ä¸Šå•é¡Œ import { ApolloServer } from 'apollo-server-express'import { ApolloServerPluginLandingPageGraphQLPlayground } from 'apollo-server-core'import express from 'express'const app = express()app.use( session({ name: 'qid', store: new RedisStore({ client: redisClient, disableTouch: true }), cookie: { maxAge: 1000 * 60 * 60 * 24 * 5, // 5 days httpOnly: true, sameSite: 'lax', secure: __prod__ }, secret: 'wefjlewf', resave: false, saveUninitialized: false // do not create empty session by default }))const apolloServer = new ApolloServer({ schema: await buildSchema({ resolvers: [PostResolver, UserResolver] }), context: ({ req, res }) =&gt; ({ em: orm.em, req, res }), plugins: [ ApolloServerPluginLandingPageGraphQLPlayground() ]}) è§£æ³•äºŒç”¨ patch-package æ–°å¢ patch, å°‡åˆ¤æ–·æ˜¯å¦ç‚º https é€£ç·šçš„åœ°æ–¹æ–°å¢æ˜¯å¦ç‚º production ç’°å¢ƒ const isProduction = process.env.NODE_ENV === 'production'if ( req.session.cookie.secure &amp;&amp; isProduction &amp;&amp; !issecure(req, trustProxy)) { debug('not secured'); return;} ä½†éœ€æ³¨æ„ï¼Œè‹¥è¦éƒ¨ç½²åˆ°çš„ heroku ä¸Šé¢çš„è©±è¦æ–°å¢è¨­å®šï¼Œè«‹åƒè€ƒæ–‡ä»¶ GitHub - ds300/patch-package: Fix broken node modules instantly ğŸƒğŸ½â€â™€ï¸ğŸ’¨","link":"/2021/10/06/%E4%BD%BF%E7%94%A8-apollo-studio-%E8%88%87-express-session-%E7%84%A1%E6%B3%95-setCookie-%E5%95%8F%E9%A1%8C/"},{"title":"ä½ çœŸçš„æ‡‚ Node.js è£¡ Libuv å¦‚ä½•ä½¿ç”¨ Thread Pool å—ï¼Ÿ","text":"ä¸å»¢è©±å…ˆä¸Šé¡Œï¼Œè«‹å•ä»¥ä¸‹ç¨‹å¼ conosole.log çš„é †åºï¼Ÿ const https = require('https');const crypto = require('crypto');const fs = require('fs');const start = Date.now();function doRequest() { https .request('https://www.google.com', res =&gt; { res.on('data', () =&gt; {}) res.on('end', () =&gt; { console.log('Request:', Date.now() - start); }) }) .end();}function doHash() { crypto.pbkdf2('a', 'b', 100000, 512, 'sha512', () =&gt; { console.log('Hash:', Date.now() - start); })}doRequest();fs.readFile('text.txt', 'utf8', () =&gt; { console.log('FS:', Date.now() - start);})doHash();doHash();doHash();doHash(); åŸ·è¡Œçµæœ ç‚ºä»€éº¼æœƒæœ‰æ­¤çµæœï¼Ÿç¬¬ä¸€å€‹é»æˆ‘éœ€è¦äº†è§£åˆ° node åº•å±¤ä½¿ç”¨äº† Libuv è™•ç†æª”æ¡ˆè®€å¯«å’Œè¨ˆç®— hash ç­‰åŠŸèƒ½ï¼ŒLibuv ç”¨äº†Thread Pool ä¸­çš„ Thread ä¾†è™•ç†é€™äº›ä»»å‹™ï¼ŒThread Pool é è¨­çš„ Thread æ•¸é‡ç‚º 4 å€‹ï¼Œæ›å¥è©±èªªåªæœ‰ 4 å€‹ Libuv è² è²¬çš„ä»»å‹™å¯ä»¥åŒæ™‚é€²è¡Œï¼Œç„¶å¾Œ https è«‹æ±‚ä¸æ˜¯ç”± Libuv è² è²¬ï¼Œè€Œæ˜¯ OS è² è²¬ï¼ŒOS æœƒæ±ºå®šæ˜¯å¦é–‹ä¸€æ¢æ–°çš„ Thread ä¾†è™•ç†æ­¤ä»»å‹™ï¼Œå› æ­¤æˆ‘å€‘å°±çœ‹åˆ°äº† HTTPS è«‹æ±‚æœ€å¿«å®Œæˆï¼Œä½†æ˜¯å•é¡Œä¾†äº†ï¼Œç‚ºä»€éº¼ fs module æª”æ¡ˆè®€äº†é€™éº¼ä¹…ï¼Ÿ é‚£æˆ‘å€‘éœ€è¦å…ˆäº†è§£è®€æª”æ¡ˆçš„æµç¨‹ ä¸Šåœ–æˆ‘å€‘å¯ä»¥çœ‹åˆ°ï¼Œ node æ²’æœ‰ç›´æ¥ç™¼ request å»è®€æª”æ¡ˆï¼Œè€Œæ˜¯åœ¨ç¬¬äºŒæ­¥æ™‚ï¼Œå…ˆå–å¾—è©²æª”æ¡ˆçš„ç‹€æ…‹è³‡è¨Šï¼Œæ‰å¾Œæ‰åœ¨ç¬¬å››æ­¥ç™¼ request å»è®€æª”æ¡ˆ æˆ‘å€‘ä¾†çœ‹åŸ·è¡Œçš„æ–¹å¼ ä¸€é–‹å§‹ fs, PBKDF2 1 ï½ 3 è™Ÿå°±å°‡ Thread Pool ç›´æ¥ä½”æ»¿äº†ï¼Œç„¶å¾Œ Thread #1 ç™¼äº† Request å»å–å¾—è©²æª”æ¡ˆçš„ç‹€æ…‹ ä½†æ˜¯ï¼ŒThread #1 ç™¼ç¾è¦ç­‰ç¡¬ç¢Ÿå°‡æª”æ¡ˆç‹€æ…‹è¿”å›ä¸çŸ¥é“è¦ç­‰å¤šä¹…ï¼Œæ‰€ä»¥ç­‰çš„æœŸé–“å°±ä¸ç¹¼çºŒåŸ·è¡Œ FS çš„ä»»å‹™äº†ï¼Œå°±è®“ FS ä»»å‹™ç­‰ä¸€ä¸‹å§ æ‰€ä»¥é€™æ™‚ Thread #1 æ‰‹ä¸Šæ²’æœ‰ä»»å‹™äº†ï¼ŒPBKDF2 #4 çš„ä»»å‹™å°±è¢«åˆ†é…çµ¦ Thread 1# åŸ·è¡Œäº† æœ€çµ‚ Thread #2, #3, #4 å…¶ä¸­ä¸€å€‹ Thread æœƒçµæŸå·¥ä½œï¼Œæˆ‘å€‘å‡è¨­ Thread #2 åšå®Œ PBKDF2 #1ï¼Œå°±æŠŠ FS çš„ä»»å‹™æ‹¿éä¾†ç¹¼çºŒåšäº†ï¼Œæˆ‘è¨˜å¾—æˆ‘å€‘å‰›å‰›è¬›åˆ° node è®€å–æª”æ¡ˆçš„æ­¥é©Ÿå—ï¼ŸNode æœƒå…ˆ Request è¦æª”æ¡ˆçš„è³‡è¨Šï¼Œå†ç™¼ Request è®€å–æª”æ¡ˆçš„å…§å®¹ï¼Œæ‰€ä»¥ç†è«–ä¸Š Thread #2 ä¹Ÿæœƒé‡åˆ°ä¸€å€‹å°‡ Request ç™¼çµ¦ç¡¬ç¢Ÿå¾Œçš„ç©ºçª—æœŸï¼Œä½†å¾Œé¢å·²ç¶“æ²’æœ‰ä»»å‹™äº†æ‰€ä»¥å®ƒå°±ç©ºè‘—ç¹¼çºŒç­‰ é€™å°±æ˜¯ç‚ºä»€éº¼æˆ‘å€‘æœƒåœ¨åŸ·è¡Œçµ¦æœçœ‹åˆ°å…ˆ Hash å…ˆå®Œæˆï¼ŒFS æœƒåœ¨å¾Œä¸€å€‹å®Œæˆ é©—æ”¶ï¼šé‚£å¦‚æœæˆ‘å€‘å°‡ Hash æ¸›å°‘åˆ°å…©å€‹ï¼Œçµæœæœƒæ˜¯å¦‚ä½•å‘¢ï¼Ÿ ç¾åœ¨æ¯å€‹ä»»å‹™éƒ½æœ‰ä¸€å€‹ Thread å»åŸ·è¡Œäº†ï¼ŒFS åè€Œè®Šæœ€å¿«äº†","link":"/2021/10/18/%E4%BD%A0%E7%9C%9F%E6%87%82-Node-js-%E8%A3%A1-Libuv-%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-Thread-Pool%E5%97%8E%EF%BC%9F/"},{"title":"Node.js æ•ˆèƒ½æå‡","text":"åœ¨ä»€éº¼æ¨£çš„æƒ…æ³ä¸‹éœ€è¦æ•ˆèƒ½æå‡ï¼Ÿå¦‚æœæˆ‘å€‘çš„ç¨‹å¼éœ€è¦é€²è¡Œé‡åº¦çš„è¨ˆç®—ï¼Œè€Œä¸”é€™å€‹ä»»å‹™ç„¡æ³•åƒ timer, http request ç­‰ï¼Œå¯ä»¥éåŒæ­¥é‹è¡Œæ™‚ï¼Œæˆ‘å€‘çš„ Request å°±æœƒè¢«å¡ä½ ex: const express = require('express');const app = express();function doWork(duration) { const start = Date.now(); while(Date.now() - start &lt; duration) {}}app.get('/', (req, res) =&gt; { doWork(5000) res.send('&lt;h1&gt;Hi There!&lt;/h1&gt;');});app.listen(3000, () =&gt; {}); æˆ‘å€‘å¯«ä¸€å€‹ doWork functionï¼Œè®“å®ƒåœ¨æ—¢å®šç§’æ•¸å…§ä¸æ–·è·‘ while è¿´åœˆ é€™å€‹æ™‚å¦‚æœé–‹å…©å€‹ tab è¼‰å…¥é é¢ï¼Œä½ å°±æœƒç™¼ç¾ç¬¬äºŒå€‹è¼‰å…¥çš„é é¢æœƒæ…¢éå¸¸å¤šï¼Œå› ç‚º server é‚„åœ¨è™•ç†ç¬¬ä¸€å€‹é é¢ï¼Œå¿…é ˆç­‰ç¬¬ä¸€å€‹é é¢è™•ç†å®Œæ‰æœƒè™•ç†ç¬¬äºŒå€‹é é¢ åˆ©ç”¨ Node.js â€œClusterâ€ Mode å¤šé–‹å¹¾å€‹ process ä¾†å¹«å¿™å§ï¼å› ç‚ºæ¯å€‹ Process éƒ½åªèƒ½ç”¨å–®æ ¸å¿ƒ CPU ä¾†é‹è¡Œï¼Œ é€é Cluster æ¨¡çµ„å°±å¯ä»¥é–‹æ›´å¤šçš„ Process ä¾†å¹«å¿™è™•ç†ï¼Œè€Œé€™å€‹Clusterçš„æ¨¡çµ„å¼·å¤§çš„åœ°æ–¹åœ¨æ–¼è®“æˆ‘å€‘åªç›£è½ä¸€å€‹Portï¼ŒåŠ ä¸ŠMaster/Workerçš„æ¦‚å¿µï¼Œç•¶æ”¶åˆ°è«‹æ±‚å¾Œå°±åˆ†é…çµ¦åº•ä¸‹çš„Workeré€²è¡Œè™•ç†ã€‚ Cluster Manager è² è²¬ç›£æ§åº•ä¸‹ Node Server çš„ç‹€æ…‹ï¼ŒCluster Manager å¯ä»¥é–‹ Node Instance, é—œé–‰ Instance, é€è³‡è¨Šçµ¦ Instance Cluster å¦‚ä½•é‹ä½œï¼Ÿä»–ä¸»è¦æ˜¯ä½¿ç”¨ child_process.fork() ç”¢ç”Ÿæ–°çš„ proccess ç”¨æ­¤ä¾†èˆ‡ master_process æºé€šã€‚ å¦‚åœ–æ‰€ç¤º åœ–ç‰‡ä¾†æº: ã€æˆ‘å¯ä»¥ä½ ä¹Ÿå¯ä»¥çš„Node.jsã€‘ç¬¬äºŒåç¯‡ - Node Cluster è®“ä½ çš„ Thread ä¸å†å­¤è»å¥®æˆ° é è¨­é…ç™¼æ–¹å¼ç•¶ä¸€å€‹è«‹æ±‚é€²ä¾†çš„æ™‚å€™é€²åˆ° master process ç„¶å¾Œç”±ä»–å»è¼ªæµæŒ‡æ´¾ ä¸€å€‹ process ã€‚ ä½¿ç”¨ Clusterä½¿ç”¨ Cluster æ™‚ï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨ cluster.isMaster å±¬æ€§å»åˆ¤æ–·ç¾åœ¨æ˜¯å¦ç‚º Master Process const cluster = require('cluster');const express = require('express');if (cluster.isMaster) { // Create child processes // Cause index.js to be executed again but in child mod cluster.fork(); cluster.fork();} else { const app = express(); function doWork(duration) { const start = Date.now(); while(Date.now() - start &lt; duration) {} } app.get('/', (req, res) =&gt; { doWork(5000) res.send('&lt;h1&gt;Hi There!&lt;/h1&gt;'); }); app.get('/fast', (req, res) =&gt; { res.send('fast'); }) app.listen(3000, () =&gt; { console.log('server listening at port 3000') });} æˆ‘å€‘æ–°å¢ä¸€å€‹ä¸æœƒé˜»å¡çš„ route /fast ï¼Œç”±æ–¼æˆ‘å€‘ç¾åœ¨æœ‰å…©å€‹ process äº†ï¼Œæ‰€ä»¥ç•¶æˆ‘å€‘é–‹å…©å€‹ tabï¼Œä¸€å€‹ç™¼åˆ° / ï¼Œå¦ä¸€å€‹å†ç™¼åˆ° /fast ï¼Œæˆ‘å€‘å¯ä»¥ç™¼ç¾ /fast ç›´æ¥å°±è¿”å›äº†ï¼Œæ²’æœ‰è¢«ä¸Šå€‹ Request å¡æ­» æ—¢ç„¶é–‹ Process å°±å¯ä»¥è®Šå¿«ï¼Œé‚£é–‹å¥½é–‹æ»¿ä¸å°±è¶…å¿«?æˆ‘å€‘é€™é‚Šå¯ä»¥ç”¨ ab (apache-benchmark) æŒ‡ä»¤ä¾†æ¸¬è©¦é–‹è¶Šå¤š child process æ˜¯å¦å°±è¶Šå¥½ ab -c 50 -n 500 localhost:3000/fast -c : concurrency çš„æ„æ€, -c 50 åŒæ™‚ä¿æŒæœ‰ 50 Request é‚„è™• pending çš„ç‹€æ…‹ -n : request çš„ç¸½æ•¸, -n 500 ä»£è¡¨ç¸½å…±ç™¼ 500 å€‹ æ¸¬è©¦æ–¹å¼ï¼šé€æ­¥å¢åŠ  Child Process å’Œ Request æ¸¬è©¦ç¨‹å¼: if (cluster.isMaster) { // é€æ­¥å¢åŠ  cluster.fork();} else { const app = express(); app.get('/', (req, res) =&gt; { crypto.pbkdf2('a', 'b', 100000, 512, 'sha512', () =&gt; { res.send('&lt;h1&gt;Hi There!&lt;/h1&gt;'); }) }); app.listen(3000, () =&gt; { console.log('server listening at port 3000') });} æ¸¬è©¦ 1 å€‹ Child Processæ¸¬è©¦æŒ‡ä»¤ ab -c -1 -n -1 localhost:3000/ æ¸¬è©¦çµæœ æ¸¬è©¦ 2 å€‹ Child Processæ¸¬è©¦æŒ‡ä»¤ ab -c -2 -n -2 localhost:3000/ æ¸¬è©¦çµæœ æ¸¬è©¦ 10 å€‹ Child Processæ¸¬è©¦æŒ‡ä»¤ ab -c -10 -n -10 localhost:3000/ æ¸¬è©¦çµæœ æ¸¬è©¦ 2 å€‹ Child Process åŒæ™‚è™•ç† 10 å€‹ Requestæ¸¬è©¦æŒ‡ä»¤ ab -c -10 -n -10 localhost:3000/ æ¸¬è©¦çµæœ æˆ‘å€‘å¯ä»¥çœ‹åˆ°ï¼Œæ–°å¢ä¸€å€‹ Child Processï¼Œç¢ºå¯¦æ˜¯è®“ 2 å€‹è«‹æ±‚ç¶­æŒåœ¨åŒä¸€æ™‚é–“è¿”å›ï¼Œä½†æ˜¯æ–°å¢åˆ°10 å€‹ Child Process æ™‚ï¼Œé¢å°åŒæ™‚ 10 å€‹è«‹æ±‚é€Ÿåº¦å»ä¸‹é™äº†ï¼Œç„¶æœƒå¾Œæœ€é©šäººçš„äº‹ï¼Œåªé–‹å…©å€‹ Child Process å»æ¯”é–‹ 10 å€‹çš„å¿«ï¼Ÿï¼Ÿï¼Ÿ Stack Overflow ä¹Ÿæœ‰äººæå‡ºç›¸ä¼¼å•é¡Œ: Node.js clustering is slower than single threaded modeï¼Œ ä½†çœ‹èµ·ä¹Ÿæœ‰æ²’æœ‰çµè«– PM2ç›¸è¼ƒèˆ‡ç›´æ¥ç”¨ cluster æ¨¡çµ„ï¼Œåœ¨ç®¡ç† process æ–¹é¢ï¼Œç¤¾ç¾¤å¤§å¤šæ•¸äººæœƒä½¿ç”¨ pm2 é–‹æºå°ˆæ¡ˆï¼Œpm2 é™¤äº†ç®¡è£¡ process ä»¥å¤–é‚„æœ‰è¨±å¤šå¯¦ç”¨çš„åŠŸèƒ½ï¼Œå¯ä»¥åƒè€ƒ Ray Leel å¤§çš„ å¥½ pm2, ä¸ç”¨å—ï¼Ÿ å®‰è£:npm i -g pm2 ä½¿ç”¨æ–¹æ³•ï¼šé–‹å•Ÿ instance: -i å¾Œé¢æ¥å¸Œæœ›å•Ÿå‹• instance çš„æ•¸é‡ï¼Œ 0 æˆ– max é»˜èªè‡ªå‹•åµæ¸¬ CPU å•Ÿå‹•æœ€å¤§å€¼ pm2 start app.js -i 0 é¡¯ç¤ºç®¡ç†ç¨‹åºç‹€æ…‹: pm2 [list|ls|status] åœæ­¢æœå‹™ï¼š pm2 stop app_name åœæ­¢ä¸¦åˆªé™¤æœå‹™: pm2 delete app_name Reference: ã€æˆ‘å¯ä»¥ä½ ä¹Ÿå¯ä»¥çš„Node.jsã€‘ç¬¬äºŒåç¯‡ - Node Cluster è®“ä½ çš„ Thread ä¸å†å­¤è»å¥®æˆ°","link":"/2021/10/20/Node-js-%E6%95%88%E8%83%BD%E6%8F%90%E5%8D%87/"},{"title":"ä½¿ç”¨ stream ä¸Šå‚³æª”æ¡ˆåˆ° Server","text":"æœ‰æ™‚å€™æª”æ¡ˆå¤ªå¤§ï¼Œæ²’æœ‰è¾¦æ³•ä¸€æ¬¡æ•´å€‹ä¸Šå‚³ï¼Œæ¯”å¦‚èªªå½±ç‰‡ã€åœ–ç‰‡ç­‰ï¼Œé€™æ™‚å€™æˆ‘å€‘å°±éœ€è¦å°‡æª”æ¡ˆæ‹†æˆä¸€å°å¡Šä¸€å°å¡Šçš„ bytes ä¸Šå‚³ å¯¦ä½œæµç¨‹ï¼š ä½¿ç”¨è€…ä¸Šå‚³æª”æ¡ˆ ç”¨ FileReader è®€å–æª”æ¡ˆå…§å®¹ å°‡æª”æ¡ˆæ‹†æˆä¸€å°å¡Šä¸€å°å¡Šå¾Œä¸Šå‚³ å¾Œç«¯æ”¶åˆ°æ¯ä¸€å°å¡Šè³‡æ–™å¾Œ append åˆ°è©²æª”æ¡ˆè£¡ å‰ç«¯çš„ç•«é¢ï¼Œä½¿ç”¨è€…å…ˆé»é¸â€œé¸æ“‡æª”æ¡ˆâ€ä¸Šå‚³æª”æ¡ˆå¾Œï¼Œåœ¨é»æ“Šå³é‚Šçš„ â€œè®€å–ï¼†ä¸Šå‚³â€å°‡æª”æ¡ˆä¸Šå‚³åˆ° Server Client éƒ¨åˆ†&lt;body&gt; &lt;h1&gt;My file uploader&lt;/h1&gt; File: &lt;input type=\"file\" id='f'&gt; &lt;button id=\"btnUpload\"&gt;Read &amp; Upload&lt;/button&gt; &lt;div id=\"divOutput\"&gt;&lt;/div&gt; &lt;script&gt; const btnUpload = document.getElementById(\"btnUpload\") const divOutput = document.getElementById('divOutput') const f = document.getElementById('f') btnUpload.addEventListener(\"click\", () =&gt; { const theFile = f.files[0]; const fileReader = new FileReader() fileReader.onload = async (e) =&gt; { const CHUNK_SIZE = 100000 // 100 kb const chunkCount = Math.ceil(e.target.result.byteLength/CHUNK_SIZE) const fileName = encodeURIComponent(Math.random() * 1000 + theFile.name) for (let chunkId = 0; chunkId &lt; chunkCount + 1; chunkId++) { const chunk = e.target.result.slice( chunkId * CHUNK_SIZE, chunkId * CHUNK_SIZE + CHUNK_SIZE ) await fetch (\"http://localhost:8080/upload\", { \"method\": \"POST\", \"headers\": { \"content-type\": \"application/octet-stream\", \"content-length\": chunk.length, \"file-name\": fileName }, \"body\": chunk }) const completePercentage = Math.floor(chunkId * 100 / chunkCount) divOutput.textContent = `${completePercentage} %` } } fileReader.readAsArrayBuffer(theFile) }) &lt;/script&gt;&lt;/body&gt; html çš„çµæ§‹ æˆ‘å€‘ä½¿ç”¨ FileReader è®€å–ä½¿ç”¨è€…ä¸Šå‚³çš„æª”æ¡ˆï¼ŒFileReader è®€åˆ°çš„è³‡æ–™å­˜ç‚º ArrayBufferï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯ bytes array, ç„¶å¾Œæˆ‘å€‘ç”¨ slice å°‡é€™äº› bytes æ‹†åˆ†ç‚ºä¸€å¡Šä¸€å¡Šçš„ chunk (ç€è¦½æœ‰é™åˆ¶æ¯å€‹ Request æœ€é«˜ 100,000 bytesï¼Œ å°±æ˜¯ 100 kb)ï¼Œä¾åºå°‡æ¯å€‹ Chunk ä¸Šå‚³ï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥é€éç›®å‰å·²ä¸Šå‚³å¤šå°‘ Chunk ä¾†è¨ˆç®—ä¸Šå‚³é€²åº¦ Header çš„ content-type éœ€è¦ç‚º application/octet-stream å› ç‚ºæˆ‘å€‘è¦ä¸Šå‚³äºŒé€²åˆ¶çš„è³‡æ–™ æ³¨æ„ï¼šæª”æ¡ˆåç¨±éœ€è¦èˆ‡ encodeUROComponent è½‰ç‚º Base64, åˆ°å¾Œç«¯å† decode å›ä¾†ï¼Œå› ç‚ºå‚³é€ä¸­æ–‡æª”åæœƒç™¼ç”ŸéŒ¯èª¤: Requestè¯·æ±‚ï¼šFailed to execute â€˜setRequestHeaderâ€™ on â€˜XMLHttpRequestâ€™: String contains non ISO-8859-1 code point. Server éƒ¨åˆ†const fs = require('fs')const http = require('http')const httpServer = http.createServer()httpServer.on(\"listening\", () =&gt; \"Listening\")httpServer.on(\"request\", (req, res) =&gt; { if (req.url === '/') { const file = fs.readFileSync('./index.html') res.end(file) return } if (req.url === '/upload') { const fileName = decodeURIComponent(req.headers[\"file-name\"]) req.on(\"data\", (chunk) =&gt; { fs.appendFileSync(fileName, chunk) console.log(`received chunk! ${chunk.length}`) }) res.end(\"uploaded\") }})httpServer.listen(8080) Server æ‹¿åˆ°è³‡æ–™å¾Œ append åˆ°è©²æª”æ¡ˆå³å¯ æ¸¬è©¦ä¸Šå‚³é€²åº¦é¡¯ç¤ºæ­£ç¢º æˆ‘å€‘çš„è³‡æ–™å¤¾ä¹Ÿç¢ºå¯¦æ”¶åˆ°æª”æ¡ˆ","link":"/2021/10/28/%E4%BD%BF%E7%94%A8-stream-%E4%B8%8A%E5%82%B3%E6%AA%94%E6%A1%88%E5%88%B0-Server/"},{"title":"æˆ‘å€‘ç‚ºä»€éº¼éœ€è¦ TLS è­‰æ›¸ï¼Ÿ","text":"æƒ³è¦äº†è§£æˆ‘å€‘ç‚ºä»€éº¼éœ€è¦ TLS è­‰æ›¸å‰ï¼Œæˆ‘å€‘å¿…é ˆå…ˆäº†è§£ï¼Œå°ç¨±åŠ å¯†èˆ‡éå°ç¨±åŠ å¯†æ˜¯ä»€éº¼ å°ç¨±åŠ å¯† (Symmetric Encryption) é›™æ–¹ä½¿ç”¨åŒä¸€æŠŠå¯†é‘°åŠ å¯†ã€è§£å¯† å„ªé»ï¼šé€Ÿåº¦å¿«ï¼ŒåŠ å¯†æ•ˆç‡é«˜ï¼Œé€šå¸¸åœ¨è¨Šæ¯å‚³é€æ–¹éœ€è¦åŠ å¯†å¤§é‡è³‡æ–™æ™‚ä½¿ç”¨ ç¼ºé»ï¼š è¬ä¸€å¯†é‘°è¢«å·ï¼Œä¸Ÿå¤±ï¼ŒåŠ å¯†çš„è³‡æ–™å°±ä¸å†å®‰å…¨ ä¸€å€‹ç¶²ç«™æœ‰å¹¾åƒè¬å€‹ç”¨æˆ¶ï¼Œæ¯å€‹ç”¨æˆ¶éƒ½è¦æ¡ç”¨ä¸åŒçš„å¯†é‘°ï¼Œå°è‡´å¯†é‘°é›£ä»¥ç®¡ç†ã€å®¹æ˜“æ´©æ¼ éå°ç¨±åŠ å¯† (Asymmetric Encryption) éå°ç¨±åŠ å¯†æœ‰å…©ç¨®é‘°åŒ™ï¼Œå…¬é‘° (public key) å’Œç§é‘°ï¼ˆsecret key)ï¼Œå…¬é‘°å°å¤–å…¬é–‹ï¼Œç§é‘°æ”¾åœ¨æœå‹™å™¨ï¼Œå®¢æˆ¶ç«¯ç”¨å…¬é‘°åŠ å¯†è³‡æ–™ï¼Œè³‡æ–™å‚³é€åˆ°æœå‹™å™¨å¾Œç”¨ç§é‘°è§£å¯†ï¼Œç•¶ä¼ºæœå™¨è¦å‚³é€è³‡æ–™åˆ°å®¢æˆ¶ç«¯æ™‚ï¼Œç”¨ç§é‘°åŠ å¯†è³‡æ–™ï¼Œå®¢æˆ¶æ”¶åˆ°è³‡æ–™å¾Œç”¨å…¬é‘°è§£å¯† å„ªé»ï¼š å¯†é‘°æ›´å®¹æ˜“ç®¡ç†ï¼Œæœå‹™å™¨ä¿ç®¡å¥½ç§é‘°å°±å¥½ å¯ä»¥ç”¨åšç¶²ç«™è­‰æ›¸çš„ç°½å å°±æ˜¯ç¶²ç«™ç”¨ç§é‘°åŠ å¯†çš„ï¼Œå…¬é‘°å¯ä»¥è§£é–‹ èˆ‰ä¾‹ï¼šç•¶æˆ‘å€‘è«‹æ±‚ google.com çš„ç¶²é æ™‚ï¼Œæˆ‘å€‘è¦æ€éº¼çŸ¥é“è©²ç¶²é çœŸçš„æ˜¯ google å‚³çš„å‘¢ï¼Ÿå°±æ˜¯ç•¶æˆ‘å€‘å¯ä»¥ç”¨å…¬é‘°è§£é–‹é€™å€‹æ–‡æª”çš„æ™‚å€™ï¼Œå› ç‚ºåªæœ‰ google æœ‰ç§é‘°å¯ä»¥åŠ å¯†é€™å€‹æ–‡æª” ç¼ºé»ï¼š é€Ÿåº¦è¼ƒæ…¢ æ··åˆåŠ å¯† (Hybrid cryptosystem)é¡§åæ€ç¾©ï¼Œçµåˆå°ç¨±èˆ‡éå°ç¨±åŠ å¯†å„è‡ªçš„å„ªé»çš„åŠ å¯†æ³• å…¶æ ¸å¿ƒç›®çš„æ˜¯: å¦‚ä½•å®‰å…¨çš„è®“å®¢æˆ¶ç«¯èˆ‡æœå‹™ç«¯æ‹¿åˆ°å°ç¨±åŠ å¯†çš„é‘°åŒ™ å‡è¨­ Alice æƒ³è¦å®‰å…¨çš„èˆ‡ Bob é€šä¿¡ Bob å…ˆç”Ÿæˆå…¬ã€ç§é‘° Bob å°‡å…¬é‘°çµ¦ Alice Alice ç”Ÿæˆä¸€æŠŠå°ç¨±åŠ å¯†çš„é‘°åŒ™ï¼Œå«åšå°è«‡é‡‘é‘° (Session Key) Alice ç”¨å°è«‡é‡‘é‘°åŠ å¯†è¦å‚³é€çš„å…§å®¹ (ä½¿ç”¨å°ç¨±åŠ å¯†) Alice ç”¨ Bob çµ¦çš„å…¬é‘°åŠ å¯†å°è«‡é‡‘é‘° (ä½¿ç”¨éå°ç¨±åŠ å¯†ï¼‰ Alice å°‡ 4,5 æ­¥çš„åŠ å¯†çµæœï¼Œä¸€èµ·å‚³çµ¦ Bob Bob æ”¶åˆ°å¾Œç”¨è‡ªå·±çš„ç§é‘°è§£å¯†å°è«‡å¯†é‘° (ä½¿ç”¨éå°ç¨±è§£å¯†ï¼‰ Bob å†æ‹¿å°è«‡å¯†é‘°è§£å¯†å‚³é€çš„å…§å®¹ (ä½¿ç”¨å°ç¨±è§£å¯†) é‚£ç‚ºä»€éº¼é‚„éœ€è¦ TLS è­‰æ›¸ï¼Ÿè½èµ·ä¾†æ··åˆåŠ å¯†å¾ˆå®‰å…¨å‘€ï¼Œé‚£å¹¹å˜›é‚„è¦ TLS è­‰æ›¸å‘€ï¼Ÿå®¢å®˜ä¸”æ…¢ï¼Œè½æˆ‘å¨“å¨“é“ä¾†é€™å€‹å¯æ€•çš„æ”»æ“Šæ‰‹æ³•å‡è¨­æˆ‘å€‘è¦è¨ªå• google.com æ™‚ï¼Œå¦‚æœæœ‰å€‹ä¸­é–“äººåœ¨ google æœå‹™å™¨å›å‚³å…¬é‘°çš„æ™‚å€™æ””æˆªäº†å…¬é‘° ä¸­é–“äººè‡ªå·±ç”Ÿæˆå…¬ã€ç§é‘°ï¼Œæˆ‘å€‘å«å®ƒå‡å…¬ã€ç§é‘° ä»–å°‡ google.com çš„å…¬é‘°æ›¿æ›æˆå‡å…¬é‘°å‚³çµ¦æˆ‘å€‘ æˆ‘å€‘æ‹¿åˆ°å‡å…¬é‘°å¾Œï¼Œæˆ‘å€‘ç”Ÿæˆå°è«‡é‡‘é‘° æˆ‘å€‘ä¸ä»¥ç‚ºæ„çš„ç”¨äº†é€™æŠŠå‡å…¬é‘°åŠ å¯†äº†å°è©±é‘°åŒ™ç„¶å¾Œå‚³çµ¦æœå‹™ç«¯ ä¸­é–“äººæ‹¿åˆ°åŠ å¯†çš„å°è©±é‘°åŒ™ ä¸­é–“äººç”¨å‡ç§é‘°è§£é–‹å°è©±é‡‘é‘°ï¼ŒæˆåŠŸæ‹¿åˆ°äº†æˆ‘å€‘çš„å°è©±é‡‘é‘° ä¸­é–“äººé€™æ™‚å› ç‚ºæ‰‹ä¸Šä¹Ÿæœ‰ google.com ä¸€é–‹å§‹å‚³çš„å…¬é‘°ï¼Œæ‰€ä»¥ä»–ä¹Ÿå¯ä»¥ä¾ç…§æ­£å¸¸çš„æ··åˆåŠ å¯†æ–¹å¼ï¼Œå°‡è‡ªå·±çš„å°è©±é‡‘é‘°å‚³çµ¦ google.comï¼Œæ‰€ä»¥é€™æ¨£ä¸€ä¾†é€™å€‹ä¸­é–“äººå°±åŒæ™‚æœ‰äº†æˆ‘å€‘å°è©±é‡‘é‘°å’Œ google å°è©±é‡‘é‘°ï¼Œèƒ½å¤ åœ¨æˆ‘å€‘èˆ‡ google.com é€šä¿¡æ™‚ï¼Œå‡è£æ˜¯ google.com å›å‚³æˆ‘å€‘å‡è³‡æ–™æˆ–è€…å‡æ‰®æˆ‘å€‘å‚³çµ¦ google.com å‡è³‡æ–™ï¼Œé€™å°±æ˜¯ä¸€ç¨® â€œä¸­é–“äººæ”»æ“Šâ€œã€‚å› æ­¤æˆ‘å€‘éœ€è¦æ‰¾ä¸€ç¨®æ–¹å¼å»è­‰æ˜ä¸€é–‹å§‹ google å‚³çš„å…¬é‘°å°±æ˜¯ google çš„ï¼Œç­”æ¡ˆå°±æ˜¯é€éä¸€å€‹å®¢æˆ¶ç«¯å’Œæœå‹™ç«¯éƒ½ç›¸ä¿¡çš„ç¬¬ä¸‰æ–¹ï¼Œå«åšæ†‘è­‰é ’ç™¼æ©Ÿæ§‹(certificate authority ç°¡ç¨± CA)ï¼Œç°½ç™¼æ†‘è­‰çµ¦æœå‹™ç«¯ é‚£æ€éº¼ç°½ç™¼è­‰æ›¸å‘¢ï¼Ÿæœå‹™å™¨å°‡è‡ªå·±çš„å…¬é‘°çµ¦ CAï¼ŒCA æœƒç”¨è‡ªå·±çš„ç§é‘°åŠ å¯†é€™æŠŠå…¬é‘°ç¨±ç‚ºæ•¸ä½ç°½å (Digital Signature)ï¼Œç„¶å¾Œé€£åŒåŸæœ¬çš„å…¬é‘°åŒ…åœ¨ä¸€èµ·ï¼Œç¨±ç‚º CA è­‰æ›¸ é‚£å®¢æˆ¶ç«¯æ€éº¼é©—è­‰ CA è­‰æ›¸?å®¢æˆ¶ç«¯è¦èˆ‡æœå‹™å™¨é€šä¿¡æ™‚ï¼Œå…ˆæŠŠ CA è­‰æ›¸å›çµ¦å®¢æˆ¶ç«¯ï¼Œå®¢æˆ¶ç«¯çœ‹è­‰æ›¸ä¸Šæ˜¯æŸ CA ç°½ç™¼çš„ï¼Œå°±æ‹¿è©² CA çš„å…¬é‘°å»è§£æ•¸å­—ç°½åï¼Œç„¶å¾Œè§£å‡ºçš„å€¼èˆ‡è­‰æ›¸ä¸Šçš„å…¬é‘°ç›¸åŒï¼Œå°±ä»£è¡¨å…¬é‘°ç¢ºå¯¦æ˜¯æœå‹™ç«¯çš„ Reference: httpså’Œå¯†ç å­¦æ•™ç¨‹2ï¼šå¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯† å°ç¨±åŠ å¯†èˆ‡éå°ç¨±åŠ å¯†å„ªç¼ºé»è©³è§£ What are SSL/TLS Certificates? Why do we Need them? and How do they Work? TTPS/SSL/TLS æ¦‚è¿°ï¼Œæ•´é«”æµç¨‹ã€æ†‘è­‰ã€æ•¸ä½ç°½ç« ","link":"/2021/11/09/%E6%88%91%E5%80%91%E7%82%BA%E4%BB%80%E9%BA%BC%E9%9C%80%E8%A6%81-TLS-%E8%AD%89%E6%9B%B8%EF%BC%9F/"},{"title":"Database Index æ˜¯ä»€éº¼ï¼Ÿ","text":"ä»¥ä¸‹æœƒä»¥ PostgreSQL ç‚ºä¾‹ PostgreSQL å°‡ table è³‡æ–™éƒ½å­˜æˆä¸€å€‹ä¸€å€‹çš„æª”æ¡ˆï¼Œæˆ‘å€‘ç¨±ç‚º Heap æˆ– Heap filesï¼ŒHeap file ç”±å¤šå€‹ Block çµ„æˆï¼Œæ¯å€‹ Block ç‚º 8KBï¼ŒBlock è£¡é¢çš„ Item æˆ–å« Tuple ï¼Œå°±æ˜¯ä¸€è¡Œä¸€è¡Œçš„ Row é—œä¿‚ï¼šHeap File &gt; Block &gt; Item å‡è¨­æˆ‘å€‘è·‘é€™å€‹ Query SELECT * FROM users WHERE username = 'Rianna'; PostgreSQL æœƒå¾ç¡¬ç¢Ÿè£¡è®€å–æ•´å€‹ Head File è¼‰å…¥åˆ°è¨˜æ†¶é«”ï¼Œç„¶å¾ŒåŸ·è¡Œ Query ï¼Œä¸€å€‹ä¸€å€‹æ‰¾ï¼Œç›´åˆ°æœ€çµ‚æ‰¾åˆ° username ç­‰æ–¼ Riannaï¼Œæˆ‘å€‘ç¨±é€™æ¨£çš„çš„æŸ¥è©¢æ–¹å¼ç‚º Full Table Scanï¼Œé€šå¸¸é€™æ¨£æœƒå°è‡´ä¸å¥½çš„æ•ˆèƒ½ Indexå¦‚æœæœ‰å€‹æ–¹æ³•å¯ä»¥æå‰çŸ¥é“ Rianna åœ¨å“ªå€‹ Blockï¼Œæˆ‘å€‘æ˜¯ä¸æ˜¯å¯å°±åªè¼‰å…¥æœ‰ Rianna åœ¨çš„ Blockï¼Œå°±å¯ä»¥å¿«é€Ÿæ‰¾åˆ° Rianna äº†ï¼Œé€™å°±æ˜¯ Indexï¼Œå¯ä»¥æƒ³åƒ Index å°±æ˜¯æ›¸çš„ç« ç¯€ç›®éŒ„ï¼Œå‘Šè¨´æˆ‘å€‘å“ªå€‹ç« ç¯€å¾ç¬¬å¹¾é é–‹å§‹ Index ä¸»è¦ç‚ºé¡å‹ç‚º B-Tree çš„çµæ§‹ï¼ŒæŸ¥æ‰¾çš„æ™‚é–“ç‚º O(log n) ï¼Œæ¯”åŸæœ¬çš„ O(n) ç›¸æ¯”å¿«å¤šäº† å»ºç«‹ indexæˆ‘å€‘å¯ä»¥ç”¨å„æ¬„ä½å»ºç«‹ index ç´¢å¼• ç”¨ username å»ºç«‹ index CREATE INDEX ON users(username); æœƒç”¨é è¨­å‘½åè¦å‰‡ä¾†å‘½å index, ex: users_username_idx å¦‚æœè¦ç‚º Index å‘½åå¯ä»¥ç”¨ï¼š CREATE INDEX {YOUR_CUSTOM_NAME} ON users(username); æ¸¬è©¦ä¸€ä¸‹çµæœå§æˆ‘å€‘å¯ä»¥åˆ©ç”¨ EXPLAIN ANALYZE èªæ³•ä¾†å¾—åˆ° Query çš„æ™‚é–“ EXPLAIN ANALYZE SELECT * FROM usersWHERE username = 'Emil30' æˆ‘å€‘ä½¿ç”¨ä¸€å¼µç´„ 5000 è¡Œ row çš„ users table åšæ¸¬è©¦ æ²’æœ‰ index åŠ å…¥ index å¾Œ OMG! ç«Ÿç„¶å¿« 25 å€ è‡ªå‹•ç”¢ç”Ÿçš„ IndexPostgreSQL æœƒå° Primary key å’Œ Unique Constraint çš„æ¬„ä½è‡ªå‹•ç”¢ç”Ÿ Index æˆ‘ä½¿ç”¨çš„ database çš„ GUI å·¥å…·æ˜¯ TablePlus ï¼Œå¯ä»¥è®“æˆ‘çœ‹åˆ°è©² table çš„æ‰€æœ‰çš„ Index å¦‚æœæ˜¯ç”¨ pgAdmin çš„è©±ï¼Œä¹Ÿå¯ç”¨ SQL å°å‡ºæ‰€æœ‰ Table çš„ index SELECT relname, relkindFROM pg_classWHERE relkind = 'i'; Index çš„ç¼ºé» éœ€è¦é¡å¤–çš„å„²å­˜ç©ºé–“ï¼šä»¥å‰›å‰› 5000 å€‹ user çš„ table ä¾†èªªï¼Œè³‡æ–™çš„å¤§å°æ˜¯ 880KBï¼Œindex å‰‡éœ€ 180KBï¼Œé€™å€‹æ•¸å­—è½èµ·ä¾†æˆ–è¨±æ²’ä»€éº¼æ„Ÿè¦ºï¼Œä½†ç¾åœ¨å¤§å®¶éƒ½æœƒç”¨ AWS, GCP ç­‰é›²ç«¯çš„æœå‹™ï¼Œç”¨æˆ¶æ•¸ä¸€å¤šï¼Œæ¯å€‹æœˆçš„é‡‘é¡ä¹Ÿæ˜¯éå¸¸é©šäººçš„ Insert å’Œ Update çš„é€Ÿåº¦æœƒè®Šæ…¢ï¼Œå› ç‚º Insert å’Œ Update æ™‚ï¼Œéœ€è¦åŒæ™‚æ›´æ–° Index","link":"/2021/12/01/Database-%E6%95%88%E8%83%BD%E8%AA%BF%E6%A0%A1-%E4%B8%80-Index/"},{"title":"AWS VPC ç­†è¨˜","text":"VPC å¯ä»¥æƒ³æˆæ˜¯ä¸€é“ç‰†ï¼Œæ²’æœ‰ä½ çš„åŒæ„å¤–é¢çš„æ±è¥¿ä¸èƒ½é€²ç‰†å…§ï¼ŒåŒç†è£¡é¢çš„æ±è¥¿ä¸èƒ½å‡ºç‰†å¤–ï¼Œä¸»è¦çš„è¨­å®šæœ‰å…©å€‹ Region IP range: ç”¨ CIDR è¡¨ç¤ºçš„çš„ IP ç¯„åœ Subnetä½ å¯ä»¥åœ¨ VPC åˆ‡ä¸€å€‹ä¸€å€‹çš„ subnet å»æ”¾ä¸åŒçš„è³‡æºï¼Œsubnet ä¸»è¦çš„ç”¨çš„åœ¨æ–¼æ›´ç²¾ç´°çš„èª¿æ•´è³‡æºçš„å–ç”¨ï¼Œæ¯”å¦‚æˆ‘ä¸€å€‹å¤–å°é–‹æ”¾çš„ backend service è·‘åœ¨ EC2 ä¸Šï¼Œé‚£æˆ‘è®€å¯ä»¥é–‹ä¸€å€‹ Subnet A æ¥å—å¤–éƒ¨è«‹æ±‚ï¼Œä½†æˆ‘çš„ DB ä¸æƒ³è¦å¯ä»¥è¢«å¤–éƒ¨é€£æ¥ï¼Œæˆ‘å¯ä»¥å°‡å¦ä¸€å€‹ subnet ä¾†æ”¾æˆ‘çš„ DB å‰µå»ºä¸€å€‹ Subnet è¦æœ‰ VPC AZ (Availablity Zone) IP range è¢« AWS ä¿ç•™çš„ IPAWS æœƒåœ¨æ¯å€‹ Subnet ä¿ç•™ 5 å€‹ IP åš networking ç®¡ç†ä½¿ç”¨ å‡è¨­ VPC çš„çš„ IP ç¯„åœæ˜¯ 10.0.0.0/22ï¼Œæ‰€ä»¥ç¸½å…±æœ‰ 1024 å€‹ IP Address, å¦‚æœå¾€ä¸‹é–‹ 4 å€‹ /24 IP ç¯„åœçš„ subnetï¼Œæ¯å€‹ subnet å¯¦éš›å¯ä»¥ä½¿ç”¨çš„ IP æ•¸é‡æ˜¯ 1024/4 - 5 = 251 æ–°æ‰‹å¦‚æœæ€• IP ä¸å¤ ç”¨çš„è©±å¯ä»¥å°‡ VPC çš„ IP ç¯„åœé–‹ç‚º /16 ç„¶å¾Œ Subnet çš„ IP ç¯„åœé–‹ç‚º /24 ï¼Œé€™æ¨£å°±ä¸æ€• IP æ•¸é‡ä¸å¤  Interent gatewayVPC æ˜¯ä¸€å€‹éš”é›¢ã€ç¨ç«‹çš„ç’°å¢ƒæ‰€ä»¥è¦è®“å¤–é¢çš„è«‹æ±‚å¯ä»¥é€²åˆ° VPCï¼Œæˆ‘å€‘éœ€è¦å‰µå»º Internet gatewayï¼Œä¸¦ä¸” Attach åˆ° VPC ä¸Šï¼Œå¯ä»¥æŠŠ Internet Gateway æƒ³æ˜¯å®¶ä¸­çš„æ•¸æ“šæ©Ÿ(modem)ï¼Œéœ€è¦å°‡é›»è…¦é€£ä¸Šæ•¸æ“šæ©Ÿæ‰èƒ½ä¸Šç¶² Virtual Private Gatewayå¦‚æœä½ åªæƒ³è¦é€£æœ¬åœ°æˆ–ç§äººæœå‹™é€£åˆ°ä½ çš„ AWS VPCï¼Œæ²’æœ‰è¦é€£æ¥å¤–ç¶²ï¼Œå¯ä»¥ä½¿ç”¨ Virtual Private Gateway(VGW)ï¼Œä½¿ç”¨ VGW å¾Œä½ å°±å¯ä»¥é€£æ¥å…¬å¸çš„å…§ç¶²æœå‹™åˆ° AWS VPCï¼ŒVGW æœƒä½¿ç”¨ VPN é€£ç·šä¾†ç¢ºä¿å®‰å…¨æ€§ Route Tableå¤–éƒ¨ Request é€ IGW é€²åˆ°äº† VPCï¼Œä½†æ˜¯ä»–æ€éº¼çŸ¥é“è¦åˆ°å“ªå€‹æˆ¿é–“(Subnet)ï¼Œéœ€è¦è¨­å®š Route Table Route Table è£¡å¯ä»¥è¨­å®šä¸€ç³»åˆ—çš„ Routesï¼Œç”¨ä¾†æ±ºå®š Network Traffic è¦å°å‘å“ªï¼ŒRoute å¯ä»¥è¨­å®šåœ¨ VPC å±¤ç´šæˆ– Subnet å±¤ç´š ç•¶ä½ å‰µå»ºä¸€å€‹æ–°çš„ VPC æ™‚ï¼ŒAWS æœƒè‡ªå‹•å‰µå»ºä¸€å€‹ Main Route Tableï¼Œä½œç”¨æ–¼æ•´å€‹ VPCï¼Œæ›å¥è©±èªªï¼Œåœ¨ VPC å…§çš„æœå‹™å¯ä»¥è‡ªç”±çš„ Access å¦ä¸€å€‹ VPC å…§çš„æœå‹™ Subnet æ˜¯å¦ç‚º Public ä¹Ÿæ˜¯ä¾æ“š Route Table çš„è¨­å®šï¼Œå¦‚æœ Subnet å’Œ IGW ä¹‹é–“æœ‰å»ºç«‹ Route å°±ä»£è¡¨é€™å€‹ Subnet æ˜¯ Public Subnet æ‰€ä»¥ä½ éœ€è¦ç‚º Subnet å‰µå»º Custom Route Table ä¾†å»ºç«‹ Subnet å’Œ IGW ä¹‹é–“çš„ Route ç¬¬ä¸€å€‹ Route æ˜¯å‰µå»º VPC å°±å‰µå»ºçš„ Main Route Table: è®“ Traffic å¯ä»¥é€²åˆ° VPC ç¬¬äºŒå€‹ Route å»ºç«‹è©² Subnet å’Œ igw é–“çš„ Routeï¼Œè®“ Traffic å¯ä»¥å€’åˆ°è©² Subnet å‰µå»º Custom Route TableVPC â†’ Route Table é¸æ“‡ VPC æ–°å¢Subnetèˆ‡ Internet Gateway é–“çš„ Route 0.0.0.0/0 èªªæ˜é€™å€‹ Route å¯ä»¥æ¥å—å’Œå‚³é€ä¾†è‡ªä»»ä½•åœ°æ–¹çš„ Traffic Target ä¸‹æ‹‰é¸å–®æ‰“ internet gatewayï¼Œæœƒå°±è‡ªå‹•è·³è©² VPC ç¾æœ‰çš„ igw çµ¦ä½ é¸ ç¶å®š Subnet èˆ‡ Route Table é¸æ“‡æˆ‘å€‘è¦ç¶å®šçš„ Subnet è¨­å®š VPC é †åº (Cheatsheet) å‰µå»º VPC å‰µå»º Subnet å‰µå»º Internet Gateway å‰µå»º Custom Route Table Reference: VPC å’Œå­ç¶²è·¯","link":"/2021/12/16/AWS-VPC-%E7%AD%86%E8%A8%98/"},{"title":"AWS Fargate å…¥é–€","text":"1. æƒ³æƒ³çœ‹å¦‚ä½•åœ¨ EC2 ä¸Šéƒ¨ç½² Containerå¦‚æœæˆ‘å€‘æƒ³è¦ä½¿ç”¨ AWS EC2 ä¾†éƒ¨ç½² Container çš„è©±ï¼Œæˆ‘å€‘å¯è¡Œçš„åšæ³•å¤§æ¦‚å¦‚ä¸‹ å‰µå»ºä¸€å€‹ VPC åœ¨ VPC è£¡å‰µå»ºå…©å€‹ä»¥ä¸Šçš„ public subnetï¼Œåˆ†åˆ¥æ”¾åˆ° 2 å€‹ Availability Zone å‰µå»º EC2 instance template ä¸¦åœ¨ user data è£¡ç‚º EC2 instance å®‰è£ Docker ä»¥å¾Œæ‹‰ä¸‹ç¨‹å¼çš„ Docker Imageï¼Œç„¶å¾Œé‹è¡Œ Containerï¼Œä¸€å€‹ EC2 instance æœƒé‹è¡Œå¤šå€‹ Container å‰µå»º EC2 Auto Scaling Group å’Œ Load Balancer å°‡æµé‡å°åˆ°é€™äº› EC2 Instance ä½†æ˜¯æˆ‘å€‘è©²å¦‚ä½•åœ¨æ¯å€‹ EC2 Instance è£¡æ”¾å…¥é€™äº› Containerï¼Œæˆ‘å€‘æœƒéœ€è¦ container orchestration ä¾†é€²è¡Œç®¡ç†ï¼Œä¹Ÿå°±æ˜¯å®¹å™¨ç·¨æ’ï¼Œé€™å°±è«‡åˆ°æˆ‘å€‘ä»Šå¤©çš„ä¸»è§’äº† â€œAWS ECSâ€ï¼Œä»¥ä¸Šæµç¨‹å»ºç«‹å‡ºä¾†çš„æ¶æ§‹å¤§æ¦‚æœƒæ˜¯é€™æ¨£ 2. AWS Fargateçœ‹å®Œä¸Šé¢çš„æ¶æ§‹å¿ƒéƒ½æ¶¼äº†ï¼Œæ˜æ˜åªæƒ³éƒ¨ç½²å€‹ Container æ€éº¼é€™éº¼å›°é›£ï¼Œé€™æ™‚å€™ AWS Fargate ä¾†æ‹¯æ•‘ä½ äº†ï¼ŒAWS Fargate æ˜¯ä¸€å€‹æœå‹™è®“ä½ ç”¨ Serverless çš„æ–¹å¼ä¾†ä½¿ç”¨ AWS ECS ï¼ŒåŸºæœ¬ä¸Šå®ƒå¹«ä½ æŠŠè¦ç®¡ç† EC2 çš„ä»»å‹™æ‹¿èµ°äº†ï¼Œæ‰€ä»¥ä½¿ç”¨çš„æ¶æ§‹åœ–å°±æœƒè®Šæˆé€™æ¨£ ä½ å¯ä»¥çœ‹åˆ° Container ä¸€æ¨£åˆ†å¸ƒåœ¨å…©å€‹ AZ åº•ä¸‹ï¼ŒContainer ä¸€æ¨£è¢« ECS ç®¡ç†ï¼Œä½†æ˜¯ä½ çœ‹ä¸åˆ° EC2ï¼Œå› ç‚º Fargate å·²ç¶“é€™å±¤æŠ½è±¡åŒ–äº†ï¼Œé€™æ¨£ä½ å°±å¯ä»¥å°ˆæ³¨é–‹ç™¼ä¸Šäº† ä½¿ç”¨ Fargateï¼Œä½ åªéœ€è¦å®šç¾© Container é‹è¡Œæ™‚éœ€è¦çš„æ±è¥¿å°±å¥½ï¼š ä½ è¦ç”¨çš„ Docker Image ä½ è¦åˆ†é…å¤šå°‘è¨˜æ†¶é«” ä½ è¦å¹¾é¡† CPU Network: Container è¦å‘å¤–é–‹å“ªå€‹ port IAM æ¬Šé™ 2.1 ç›¸é—œåè©è§£é‡‹åœ¨é–‹å§‹å¯¦ä½œå‰æˆ‘å€‘æœ‰äº›å°ˆæœ‰åè©éœ€è¦çŸ¥é“ï¼Œé€™äº›å°ˆæœ‰åè©å…¶å¯¦ä¾†è‡ª ECS Cluster: å¯ä»¥æƒ³æˆæ˜¯ä¸€å€‹ç•Œå®šçš„ç¯„åœå…§çš„ infrastructure ç”¨ä¾†éƒ¨ç½²ä½ çš„ Containerï¼Œä½ å¯ä»¥åœ¨ä»»ä½• VPC ä¸‹å®šç¾© Clusterï¼Œä½ å¯ä»¥é¸æ“‡è¦å°‡ Container éƒ¨ç½²åœ¨å“ªäº› subnet åº•ä¸‹ï¼ŒFargate æœƒå¹«ä½ ç®¡ç† Cluster Service å’Œ Task: Service å°‡ Task éƒ¨ç½²ä½ åˆ°ä½ çš„ Cluster è£¡ï¼ŒTask æ˜¯ä¸€å±¤ç”¨ä¾†é‹è¡Œ Container çš„ Wrapper Container Definition: ç”¨ä¾†å®šç¾© Container ä¸€äº›åŸ·è¡Œæ™‚çš„ç›¸é—œè¨­å®šï¼Œex: image memory, port Task Definition: ä¹Ÿç”¨ä¾†å®šç¾© Container ä¸€äº›åŸ·è¡Œæ™‚çš„ç›¸é—œè¨­å®šï¼Œex: IAM ç­‰ Service: å®šç¾©ä½ è¦è·‘å¹¾å€‹ Containerã€ã€Load Balancer ä¸€å±¤ä¸€å±¤å‘å¤–è¨­å®š 2.2 å¯¦ä½œï¼šç”¨ Fargate éƒ¨ç½²ä¸€å€‹ Nginx Containeråˆ° ECS é é¢å¾Œé¸æ“‡ä¸‹ Get Started å®šç¾© Container Definition å’Œ Task definition é¸æ“‡ Nginx é» Next å°±å¥½ï¼ŒAWS é è¨­ Task Definition åç¨±æ˜¯ first-run-task-definition å®šç¾© Service ä¸€æ¨£ï¼Œä¸éœ€è¦æ›´æ”¹ï¼Œç›´æ¥ä¸‹ä¸€æ­¥å°±å¥½ï¼Œé è¨­çš„ Security Group å·²ç¶“é–‹å•Ÿ 80 port äº† å®šç¾© Cluster é€™é‚Šæˆ‘å°‡ Cluster åç¨±æ”¹æˆ nginx-test-clusterï¼Œæ–¹ä¾¿ç­‰ä¸€ä¸‹è¾¨èª æœ€å¾Œçœ‹ä¸€ä¸‹æ²’å•é¡Œå°±æŒ‰ä¸‹ Create ç­‰ Task çš„ç‹€æ…‹è®Šç‚º Running å¾Œï¼Œæˆ‘å€‘å°±å¯ä»¥é€£åˆ°å‰›å‰›å‰µå»ºçš„ Nginx Container äº† å°‡ Public IP è²¼åˆ°ç€è¦½å™¨å°±å¯ä»¥çœ‹åˆ° Nginx çš„ html äº†","link":"/2021/12/17/AWS-Fargate-%E5%85%A5%E9%96%80/"},{"title":"å»ºç«‹ React Web å’Œ React Native çš„ Monorepo","text":"ä½¿ç”¨ React Native é–‹ç™¼ APP çš„ä¸€å¤§å¥½è™•å°±æ˜¯å¯ä»¥èˆ‡ React Web å…±ç”¨ç¨‹å¼ï¼Œé™¤äº† UI, Routing ç­‰ç„¡æ³•å…±ç”¨ä»¥å¤–ï¼Œå•†æ¥­é‚è¼¯ã€hooksã€utilsã€api å±¤è™•ç†ï¼Œé€šé€šå¯ä»¥å…±ç”¨ï¼Œè¦é”åˆ°æ­¤ç›®çš„æˆ‘å€‘å¯ä»¥ä½¿ç”¨ Monorepoï¼Œå¦‚æœä¸çŸ¥é“ Monorepo æ˜¯ä»€éº¼çš„å¯ä»¥åƒè€ƒ Fireship çš„å½±ç‰‡ï¼Œæ¦‚å¿µä¸Šå°±æ˜¯å°‡æ‰€æœ‰çš„å°ˆæ¡ˆéƒ½æ”¾åœ¨åŒä¸€å€‹ repo ä¸‹é”åˆ°æ–¹ä¾¿å…±ç”¨çš„ç›®çš„ Monorepos - How the Pros Scale Huge Software Projects // Turborepo vs Nx 1. å»ºç«‹å°ˆæ¡ˆé€™æˆ‘å€‘è¦åšçš„æ–‡ä»¶å¤¾çµæ§‹ï¼Œå„å€‹å°ˆæ¡ˆæ”¾åœ¨ packages çš„è³‡æ–™å¤¾å…§ï¼Œå…¶ä¸­çš„ common è³‡æ–™å¤¾æ˜¯æ”¾ app èˆ‡ web å…±ç”¨çš„ç¨‹å¼ â”œâ”€â”€ package.jsonâ””â”€â”€ packages â”œâ”€â”€ app â”œâ”€â”€ common â””â”€â”€ web 1.1 å»ºç«‹æ–‡ä»¶å¤¾èˆ‡å„å°ˆæ¡ˆcd åˆ° packages ç›®éŒ„å¾Œï¼Œä½¿ç”¨ CLI å·¥å…·å»ºç«‹å„å°ˆæ¡ˆ APP çš„éƒ¨åˆ†ä½¿ç”¨ React Native CLIï¼Œé€™è£¡æˆ‘å€‘è¨­å®šä½¿ç”¨ TypeScript çš„æ¨¡æ¿ npx react-native init app --template react-native-template-typescript Web çš„éƒ¨åˆ†ä½¿ç”¨ Create-React-App npx create-react-app web --template typescript 2. è¨­å®š Yarn Workspaceå…ˆç§»é™¤å„å°ˆæ¡ˆä¸­çš„ node_modules rm -rf packages/*/node_modules/ é€™ç†æˆ‘å€‘ä½¿ç”¨ Yarn Workspace ä¾†å»ºç«‹ Monorepoï¼Œç•¶ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶å®ƒçš„å·¥å…·åƒæ˜¯ Nx, Turborepo, Lerna ç­‰ï¼Œæœ‰æ©Ÿæœƒä¹‹å¾Œè©¦ç©çœ‹çœ‹åœ¨å¯«æ–‡ç« èˆ‡å¤§å®¶åˆ†äº«å·®åˆ¥åœ¨å“ª è¨­å®šå°ˆæ¡ˆæ ¹ç›®éŒ„çš„ package.jsonï¼ŒåŠ ä¸Š private ç‚º true å’Œworkspaces å±¬æ€§ { \"private\": true, \"name\": \"todo\", \"version\": \"1.0.0\", \"description\": \"\", \"main\": \"index.js\", \"scripts\": { \"test\": \"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\" }, \"keywords\": [], \"author\": \"\", \"license\": \"ISC\", \"workspaces\": { \"packages\": [\"packages/*\"], \"nohoist\": [\"**/react-native\", \"**/react-native/**\"] }} æ ¹ç›®éŒ„çš„ package.json å…¶ä¸­æ¯”è¼ƒç‰¹åˆ¥çš„æ˜¯ nohoist å±¬æ€§ï¼Œå› ç‚º yarn workspaces æœƒå°‡æ‰€æœ‰çš„ dependencies éƒ½å®‰è£åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„ä¸­çš„ node_modules è£¡ï¼Œä¾†é¿å…åº•ä¸‹çš„å°ˆæ¡ˆå®‰è£åŒæ¨£çš„åŒ…ï¼Œä¾†é”åˆ°å…±äº«ä¾è³´åŒ…çš„æ©Ÿåˆ¶ï¼Œyarn åœ¨ packages çš„å°ˆæ¡ˆè£¡çš„ node_modules æœƒå‰µå»º symlinks (è»Ÿéˆçµ)ï¼Œä¾†è®“å°ˆæ¡ˆå¯ä»¥æ‰¾åˆ°éœ€è¦çš„ä¾è³´åŒ… ä½†æ˜¯ react-native æ‰€ä½¿ç”¨çš„ metro bundler æ²’æœ‰æ”¯æ´ symlinks çš„åŠŸèƒ½ï¼Œæ‰€ä»¥ react-native å°ˆæ¡ˆéœ€è¦çš„å¥—ä»¶å¿…é ˆåœ¨ app ç›®éŒ„è£¡çš„ node_moudles è£¡ï¼Œmetro åœ¨æ‰“åŒ…æ™‚æ‰æ‰¾å¾—åˆ° 3. è¨­å®šå…±ç”¨å°ˆæ¡ˆåœ¨ packages ç›®éŒ„æ–°å¢ä¸€å€‹ common è³‡æ–™å¤¾ï¼Œç„¶å¾Œä½¿ç”¨ npm init -y ä¾†æ–°å¢ä¸€å€‹ npm æ¨¡çµ„ï¼Œæ›´æ”¹ package.json ä¾†èª¿æ•´å¥—ä»¶åç¨±ï¼Œæ–¹ä¾¿ä¹‹å¾Œåœ¨ app æˆ– web çš„å°ˆæ¡ˆè£¡è¾¨è­˜ å¦‚æœè¦ç”¨ TypeScript çš„è©±ï¼Œè¨˜å¾—å°‡ package.json è£¡çš„ main å±¬æ€§æ”¹ç‚º index.tsï¼Œé€™æœƒè¨­å®šé€™å€‹å°ˆæ¡ˆçš„ä¸»è¦æª”æ¡ˆç‚º index.ts { \"name\": \"&lt;ä½ çš„å°ˆæ¡ˆåç¨±&gt;/common\", \"version\": \"1.0.0\", \"description\": \"\", \"main\": \"index.ts\", &lt;-- å¦‚æœæœ‰ç”¨ TypeScript çš„è©±ï¼Œè¨˜å¾—æ”¹é€™è£¡ \"scripts\": { \"test\": \"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\" }, \"keywords\": [], \"author\": \"\", \"license\": \"ISC\"} common çš„ package.json ç„¶å¾Œè©¦è‘—æ–°å¢ä¸€å€‹ index.tsï¼Œexport ä¸€å€‹ function æ–¹ä¾¿æˆ‘å€‘æ¸¬è©¦ export function testFunction () { console.log('test function fire');} index.ts 4. ä½¿ç”¨å…±ç”¨å°ˆæ¡ˆåœ¨ app çš„ pacakge.json ä¸­æ–°å¢å…±ç”¨ä¾è³´åŒ… \"dependencies\": { \"react\": \"17.0.2\", \"react-native\": \"0.68.1\", + \"&lt;ä½ çš„å°ˆæ¡ˆ&gt;/common\": \"1.0.0\" }, ç„¶å¾Œè·‘ä¸€æ¬¡ yarn æŒ‡ä»¤ä¾†å®‰è£ä¾è³´åŒ… åˆ°é€™è£¡æˆ‘å€‘é‚„ä¸èƒ½ä½¿ç”¨ common åŒ…è£¡çš„ç¨‹å¼ï¼Œæˆ‘å€‘éœ€è¦è¨­å®š metro ä¾†è®€å–æ ¹ç›®éŒ„çš„ node_modulesï¼Œå› ç‚ºæˆ‘å€‘çš„ common åŒ…æœƒè¢«æ”¾åœ¨é‚£ const path = require('path');module.exports = { transformer: { getTransformOptions: async () =&gt; ({ transform: { experimentalImportSupport: true, inlineRequires: true, }, }), }, resolver: { extraNodeModules: { 'node_modules': path.resolve(__dirname, '..', '..') } }, watchFolders: [ path.resolve(path.join(__dirname, '../..')) ]}; æˆ‘å€‘ä¸»è¦è¨­å®šäº† resolver è£¡çš„ extraNodeModules ç‚ºæ ¹ç›®éŒ„çš„ node_modules è¨­å®š watchFolders ç›£çœ‹æ•´å€‹å°ˆæ¡ˆ 5. æ¸¬è©¦çœ‹çœ‹å§æˆ‘å€‘åˆ†åˆ¥åœ¨ app è·Ÿ web çš„ App.tsx å…ƒä»¶è£¡ä½¿ç”¨å‰›å‰›å¾ common è£¡ export çš„ function æ¸¬è©¦ Appimport { testFunction } from '@todo/common'const App = () =&gt; { testFunction() const isDarkMode = useColorScheme() === 'dark'; const backgroundStyle = { backgroundColor: isDarkMode ? Colors.darker : Colors.lighter, }; return ( &lt;SafeAreaView style={backgroundStyle}&gt; // ... ä»¥ä¸‹çœç•¥ &lt;/SafeAreaView&gt; );}; æ¸¬è©¦ Webimport React from 'react';import logo from './logo.svg';import './App.css';import { testFunction } from '@todo/common';function App() { testFunction() return ( // ...çœç•¥ );}export default App; web çš„ App.tsx","link":"/2022/05/04/%E5%BB%BA%E7%AB%8B-React-Web-%E5%92%8C-React-Native-%E7%9A%84-Monorepo/"}],"tags":[{"name":"Linux","slug":"Linux","link":"/tags/Linux/"},{"name":"Python","slug":"Python","link":"/tags/Python/"},{"name":"express","slug":"express","link":"/tags/express/"},{"name":"graphql","slug":"graphql","link":"/tags/graphql/"},{"name":"node.js","slug":"node-js","link":"/tags/node-js/"},{"name":"python","slug":"python","link":"/tags/python/"},{"name":"react-native","slug":"react-native","link":"/tags/react-native/"},{"name":"javascript","slug":"javascript","link":"/tags/javascript/"},{"name":"Computer Networking","slug":"Computer-Networking","link":"/tags/Computer-Networking/"},{"name":"Database","slug":"Database","link":"/tags/Database/"},{"name":"AWS","slug":"AWS","link":"/tags/AWS/"},{"name":"react","slug":"react","link":"/tags/react/"}],"categories":[{"name":"Backend","slug":"Backend","link":"/categories/Backend/"}]}